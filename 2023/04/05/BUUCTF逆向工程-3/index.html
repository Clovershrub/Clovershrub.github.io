<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BUUCTF逆向工程-3 | Clovershrub</title><meta name="author" content="Clovershrub"><meta name="copyright" content="Clovershrub"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="BUUCTF逆向工程-3[2019红帽杯]childRE很神奇的一道题，不过为啥红帽杯的题都多多少少有点阴间成分？首先看到它的验证部分，这个很好逆。运行如下代码： 123456789101112131415161718192021222324252627#include &lt;iostream&gt;#include &lt;cstring&gt;using namespace std;int">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF逆向工程-3">
<meta property="og:url" content="https://clovershrub.github.io/2023/04/05/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/index.html">
<meta property="og:site_name" content="Clovershrub">
<meta property="og:description" content="BUUCTF逆向工程-3[2019红帽杯]childRE很神奇的一道题，不过为啥红帽杯的题都多多少少有点阴间成分？首先看到它的验证部分，这个很好逆。运行如下代码： 123456789101112131415161718192021222324252627#include &lt;iostream&gt;#include &lt;cstring&gt;using namespace std;int">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://clovershrub.github.io/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/cover.jpg">
<meta property="article:published_time" content="2023-04-04T16:00:00.000Z">
<meta property="article:modified_time" content="2023-11-27T08:12:10.444Z">
<meta property="article:author" content="Clovershrub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://clovershrub.github.io/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/cover.jpg"><link rel="shortcut icon" href="/img/blogs/avatar.jpg"><link rel="canonical" href="https://clovershrub.github.io/2023/04/05/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF逆向工程-3',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-27 16:12:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Clovershrub" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/blogs/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/cover.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Clovershrub"></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF逆向工程-3</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2023-04-04T16:00:00.000Z" title="Created 2023-04-05 00:00:00">2023-04-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF逆向工程-3"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="BUUCTF逆向工程-3"><a href="#BUUCTF逆向工程-3" class="headerlink" title="BUUCTF逆向工程-3"></a>BUUCTF逆向工程-3</h1><h2 id="2019红帽杯-childRE"><a href="#2019红帽杯-childRE" class="headerlink" title="[2019红帽杯]childRE"></a>[2019红帽杯]childRE</h2><p>很神奇的一道题，不过为啥红帽杯的题都多多少少有点阴间成分？<br>首先看到它的验证部分，这个很好逆。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5DchildRE1.png"><br>运行如下代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> ans[<span class="number">99</span>] = <span class="string">&quot;1234567890-=!@#$%^&amp;*()_+qwertyuiop[]QWERTYUIOP&#123;&#125;asdfghjkl;&#x27;ASDFGHJKL:\&quot;ZXCVBNM&lt;&gt;?zxcvbnm,./&quot;</span>;</span><br><span class="line">    <span class="type">char</span> num[<span class="number">99</span>] = <span class="string">&quot;55565653255552225565565555243466334653663544426565555525555222&quot;</span>;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">99</span>] = <span class="string">&quot;(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> i, pos;</span><br><span class="line">    pos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">32</span>; i &lt; <span class="number">125</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(ans[i % <span class="number">23</span>] == str[pos] &amp;&amp; ans[i / <span class="number">23</span>] == num[pos])</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">char</span>(i);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        pos++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(pos &lt; <span class="number">62</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>就可以得到<br><code>private: char * __thiscall R0Pxx::My_Aut0_PWN(unsigned char *)</code><br>而前文中存在UnDecorateSymbolName()函数。因此我们得到的字符串是某个函数去修饰后的样子。<br>根据<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Clovershrub/p/17154427.html">这篇文章</a>可以知道函数去修饰前应该是<code>?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z</code><br>继续跟踪它与输入的关系可以找到找到这个函数：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5DchildRE2.png"><br>不用怀疑，这个b绝对是二叉树。为什么呢？被恶心多了就记住了。看规则是后序遍历，手动算一下遍历顺序，写出代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> raw[<span class="number">99</span>] = <span class="string">&quot;?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z&quot;</span>;</span><br><span class="line">    <span class="type">char</span> ans[<span class="number">99</span>];</span><br><span class="line">    <span class="type">int</span> order[<span class="number">99</span>] = &#123;<span class="number">15</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">9</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">13</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">31</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[order[i]] = raw[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">31</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; ans[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到<code>Z0@tRAEyuP@xAAA?M_A0_WNPx@@EPDP</code><br>将其32位小写md5加密后得到flag：63b148e750fed3a33419168ac58083f5</p>
<h2 id="SWPU2019-ReverseMe"><a href="#SWPU2019-ReverseMe" class="headerlink" title="[SWPU2019]ReverseMe"></a>[SWPU2019]ReverseMe</h2><p>这道题代码写得很神奇，反正我没看得太懂，所以嗯逆非常滴恶心。<br>下面这一段是本题唯一可以看得懂的东西。其中v29很奇怪，会莫名其妙地变掉从而执行if。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSWPU2019%5DReverseMe1.png"><br>接着是sub_6525C0()函数中加密的部分。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSWPU2019%5DReverseMe2.png"><br>然后是主函数中的对比部分。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSWPU2019%5DReverseMe3.png"><br>它的代码写得非常莫名其妙，所以采用动调回事一种很好的方法。动调的时候一定要对着汇编码，随便输入点啥，然后把跟Str异或之后的东西前几位记一下。接着就不停地找哪个寄存器是这一串东西，它的值什么时候变了，就能找到加密的地方。写出代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">20</span>] = <span class="string">&quot;SWPU_2019_CTF&quot;</span>;</span><br><span class="line">    <span class="type">int</span> Xor[<span class="number">99</span>] = &#123;<span class="number">134</span>,  <span class="number">12</span>,  <span class="number">62</span>, <span class="number">202</span>, <span class="number">152</span>, <span class="number">215</span>, <span class="number">174</span>,  <span class="number">25</span>, <span class="number">226</span>, <span class="number">119</span>, </span><br><span class="line">  <span class="number">107</span>, <span class="number">166</span>, <span class="number">106</span>, <span class="number">161</span>, <span class="number">119</span>, <span class="number">176</span>, <span class="number">105</span>, <span class="number">145</span>,  <span class="number">55</span>,   <span class="number">5</span>, </span><br><span class="line">  <span class="number">122</span>, <span class="number">249</span>, <span class="number">123</span>,  <span class="number">48</span>,  <span class="number">67</span>,  <span class="number">90</span>,  <span class="number">75</span>,  <span class="number">16</span>, <span class="number">134</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">212</span>,  <span class="number">40</span>, <span class="number">171</span>, <span class="number">171</span>, <span class="number">171</span>, <span class="number">171</span>, <span class="number">171</span>, <span class="number">171</span>, <span class="number">171</span>, <span class="number">171</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>, <span class="number">246</span>, </span><br><span class="line">  <span class="number">245</span>,  <span class="number">17</span>,  <span class="number">13</span>, <span class="number">244</span>,   <span class="number">0</span>,  <span class="number">24</span>&#125;;</span><br><span class="line">    <span class="type">int</span> input[<span class="number">99</span>] = &#123;<span class="number">179</span>,  <span class="number">55</span>,  <span class="number">15</span>, <span class="number">248</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">174</span>,  <span class="number">93</span>, <span class="number">186</span>,  <span class="number">90</span>, </span><br><span class="line">   <span class="number">77</span>, <span class="number">134</span>,  <span class="number">68</span>, <span class="number">151</span>,  <span class="number">98</span>, <span class="number">211</span>,  <span class="number">79</span>, <span class="number">186</span>,  <span class="number">36</span>,  <span class="number">22</span>, </span><br><span class="line">   <span class="number">11</span>, <span class="number">159</span>, <span class="number">114</span>,  <span class="number">26</span>, <span class="number">101</span>, <span class="number">104</span>, <span class="number">109</span>,  <span class="number">38</span>, <span class="number">186</span>, <span class="number">107</span>, </span><br><span class="line">  <span class="number">200</span>, <span class="number">103</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        input[i] ^= str[i % <span class="built_in">strlen</span>(str)];</span><br><span class="line">        input[i] ^= Xor[i];</span><br><span class="line">        cout &lt;&lt; <span class="built_in">char</span>(input[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：Y0uaretheB3st!#@_VirtualCC</p>
<h2 id="羊城杯-2020-login"><a href="#羊城杯-2020-login" class="headerlink" title="[羊城杯 2020]login"></a>[羊城杯 2020]login</h2><p>是一个简单的pyinstaller逆向，下载<a href="/file/pyinstxtractor.zip">这个</a>，在命令行里输入<br><code>python pyinstxtractor.py attachment.exe</code><br>会得到一个文件夹，在文件夹里找到login.pyc，把它传到<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">这里</a>就可以了。<br>是个简单的异或和z3，得到flag：58964088b637e50d3a22b9510c1d1ef8</p>
<h2 id="QCTF2018-Xman-babymips"><a href="#QCTF2018-Xman-babymips" class="headerlink" title="[QCTF2018]Xman-babymips"></a>[QCTF2018]Xman-babymips</h2><p>简单的异或加密，注意要取后两位，即x &amp; 0xFF。<br>得到flag：ReA11y_4_B@89_mlp5_4_XmAn_</p>
<h2 id="安洵杯-2019-crackMe"><a href="#安洵杯-2019-crackMe" class="headerlink" title="[安洵杯 2019]crackMe"></a>[安洵杯 2019]crackMe</h2><p>很牛逼的一道题。<br>根据findcrypt插件或者运行后搜索弹出的提示词可以找到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5DcrackMe1.png"><br>上面一大段是对base表进行更改，下面一段看不懂。跟进得到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5DcrackMe2.png"><br>其中sub_411172()是生成SM4加密所需轮秘钥(RK)。查看RK的交叉引用可以得到SM4的加密过程：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5DcrackMe3.png"><br>跟进TopLevelExceptionFilter可以找到校验部分：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5DcrackMe4.png"><br>在base64加密过程中有魔改的地方：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5DcrackMe5.png"><br>即：base表需要向前移动24个，同时最后的等号由叹号代替。<br>解密得到flag：SM4foRExcepioN?!<br>官方文档介绍说这个程序在main函数之前hook了MessageBoxW()函数，之后又调用了这个函数。因此在执行MessageBoxW()前先修改base表并创建VEH向量。执行函数后注册SEH并触发异常。在VEH中构造轮秘钥并注册UnhandledExceptionFilter。在SEH中进行SM4加密。在UnhandledExceptionFilter中修改对比结果并进行变种base64。最后执行比较函数。挺好的，都是中国字&#x3D;&#x3D;我看懂了。</p>
<h2 id="UTCTF2020-babymips"><a href="#UTCTF2020-babymips" class="headerlink" title="[UTCTF2020]babymips"></a>[UTCTF2020]babymips</h2><p>没啥技术含量。<br>得到flag：mips_cpp_gang_5VDm:~&#96;N]ze;\)5%vZ&#x3D;C’C(r#$q&#x3D;*efD”ZNY_GX&gt;6&amp;sn.wF8$v*mvA@’</p>
<h2 id="GKCTF-2021-QQQQT"><a href="#GKCTF-2021-QQQQT" class="headerlink" title="[GKCTF 2021]QQQQT"></a>[GKCTF 2021]QQQQT</h2><p>根据字符串找到base58加密<br>得到flag：12t4tww3r5e77</p>
<h2 id="NPUCTF2020-你好sao啊"><a href="#NPUCTF2020-你好sao啊" class="headerlink" title="[NPUCTF2020]你好sao啊"></a>[NPUCTF2020]你好sao啊</h2><p>这题有意思，需要对给定的数据进行base64加密，然后才可以得到结果<br>得到flag：w0w+y0U+cAn+r3lllY+dAnc3</p>
<h2 id="WUSTCTF2020-funnyre"><a href="#WUSTCTF2020-funnyre" class="headerlink" title="[WUSTCTF2020]funnyre"></a>[WUSTCTF2020]funnyre</h2><p>五个花指令和1000+行的屎山，没什么技术含量<br>得到flag：1dc20f6e3d497d15cef47d9a66d6f1af</p>
<h2 id="GUET-CTF2019-encrypt"><a href="#GUET-CTF2019-encrypt" class="headerlink" title="[GUET-CTF2019]encrypt"></a>[GUET-CTF2019]encrypt</h2><p>先魔改RC4，再魔改base64：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BGUET-CTF2019%5Dencrypt1.png"><br>魔改RC4部分的Sbox可以通过动调get_key()函数获得，sub_4007DB()函数如下：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BGUET-CTF2019%5Dencrypt2.png"><br>这个部分比较简单，逆的时候抄下来跑一边就行。而魔改base64如下：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BGUET-CTF2019%5Dencrypt3.png"><br>可以发现它采用的base表是以&#x3D;开头的，依照ascii码递增的64位字符串，即<br><code>=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|</code><br>可以写出代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> box[<span class="number">999</span>] = &#123;</span><br><span class="line">        <span class="number">176</span>, <span class="number">49</span>, <span class="number">117</span>, <span class="number">112</span>, <span class="number">248</span>, <span class="number">223</span>, <span class="number">7</span>, <span class="number">60</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">80</span>, <span class="number">41</span>, <span class="number">44</span>, <span class="number">22</span>, <span class="number">105</span>, <span class="number">18</span>, <span class="number">200</span>, <span class="number">43</span>, <span class="number">59</span>, <span class="number">127</span>, <span class="number">178</span>,</span><br><span class="line">        <span class="number">231</span>, <span class="number">75</span>, <span class="number">104</span>, <span class="number">140</span>, <span class="number">197</span>, <span class="number">166</span>, <span class="number">21</span>, <span class="number">3</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">141</span>, <span class="number">135</span>, <span class="number">38</span>, <span class="number">9</span>, <span class="number">237</span>, <span class="number">23</span>, <span class="number">138</span>, <span class="number">194</span>, <span class="number">242</span>, <span class="number">67</span>, <span class="number">192</span>,</span><br><span class="line">        <span class="number">172</span>, <span class="number">89</span>, <span class="number">151</span>, <span class="number">245</span>, <span class="number">63</span>, <span class="number">103</span>, <span class="number">94</span>, <span class="number">57</span>, <span class="number">134</span>, <span class="number">213</span>, <span class="number">114</span>, <span class="number">97</span>, <span class="number">218</span>, <span class="number">247</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">139</span>, <span class="number">195</span>, <span class="number">177</span>, <span class="number">119</span>, <span class="number">175</span>, <span class="number">29</span>,</span><br><span class="line">        <span class="number">48</span>, <span class="number">198</span>, <span class="number">69</span>, <span class="number">14</span>, <span class="number">95</span>, <span class="number">238</span>, <span class="number">174</span>, <span class="number">240</span>, <span class="number">40</span>, <span class="number">206</span>, <span class="number">205</span>, <span class="number">167</span>, <span class="number">155</span>, <span class="number">42</span>, <span class="number">25</span>, <span class="number">72</span>, <span class="number">8</span>, <span class="number">68</span>, <span class="number">32</span>, <span class="number">254</span>, <span class="number">109</span>, <span class="number">181</span>,</span><br><span class="line">        <span class="number">46</span>, <span class="number">106</span>, <span class="number">241</span>, <span class="number">52</span>, <span class="number">188</span>, <span class="number">30</span>, <span class="number">62</span>, <span class="number">204</span>, <span class="number">65</span>, <span class="number">146</span>, <span class="number">216</span>, <span class="number">189</span>, <span class="number">165</span>, <span class="number">232</span>, <span class="number">77</span>, <span class="number">10</span>, <span class="number">73</span>, <span class="number">13</span>, <span class="number">162</span>, <span class="number">250</span>, <span class="number">98</span>, <span class="number">116</span>,</span><br><span class="line">        <span class="number">212</span>, <span class="number">131</span>, <span class="number">150</span>, <span class="number">148</span>, <span class="number">61</span>, <span class="number">203</span>, <span class="number">24</span>, <span class="number">99</span>, <span class="number">153</span>, <span class="number">70</span>, <span class="number">202</span>, <span class="number">183</span>, <span class="number">142</span>, <span class="number">207</span>, <span class="number">251</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">126</span>, <span class="number">81</span>, <span class="number">39</span>, <span class="number">96</span>,</span><br><span class="line">        <span class="number">154</span>, <span class="number">17</span>, <span class="number">243</span>, <span class="number">92</span>, <span class="number">110</span>, <span class="number">186</span>, <span class="number">66</span>, <span class="number">118</span>, <span class="number">47</span>, <span class="number">239</span>, <span class="number">191</span>, <span class="number">33</span>, <span class="number">170</span>, <span class="number">228</span>, <span class="number">214</span>, <span class="number">27</span>, <span class="number">85</span>, <span class="number">125</span>, <span class="number">190</span>, <span class="number">234</span>, <span class="number">211</span>,</span><br><span class="line">        <span class="number">16</span>, <span class="number">244</span>, <span class="number">199</span>, <span class="number">74</span>, <span class="number">35</span>, <span class="number">121</span>, <span class="number">132</span>, <span class="number">164</span>, <span class="number">28</span>, <span class="number">171</span>, <span class="number">20</span>, <span class="number">219</span>, <span class="number">76</span>, <span class="number">58</span>, <span class="number">184</span>, <span class="number">82</span>, <span class="number">236</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">182</span>, <span class="number">210</span>, <span class="number">160</span>,</span><br><span class="line">        <span class="number">90</span>, <span class="number">91</span>, <span class="number">152</span>, <span class="number">102</span>, <span class="number">84</span>, <span class="number">158</span>, <span class="number">78</span>, <span class="number">79</span>, <span class="number">180</span>, <span class="number">196</span>, <span class="number">201</span>, <span class="number">208</span>, <span class="number">37</span>, <span class="number">156</span>, <span class="number">128</span>, <span class="number">222</span>, <span class="number">45</span>, <span class="number">6</span>, <span class="number">34</span>, <span class="number">11</span>, <span class="number">145</span>, <span class="number">107</span>,</span><br><span class="line">        <span class="number">159</span>, <span class="number">246</span>, <span class="number">230</span>, <span class="number">226</span>, <span class="number">193</span>, <span class="number">15</span>, <span class="number">147</span>, <span class="number">144</span>, <span class="number">123</span>, <span class="number">157</span>, <span class="number">143</span>, <span class="number">221</span>, <span class="number">229</span>, <span class="number">101</span>, <span class="number">53</span>, <span class="number">173</span>, <span class="number">169</span>, <span class="number">220</span>, <span class="number">130</span>, <span class="number">187</span>,</span><br><span class="line">        <span class="number">0</span>, <span class="number">83</span>, <span class="number">209</span>, <span class="number">168</span>, <span class="number">51</span>, <span class="number">233</span>, <span class="number">64</span>, <span class="number">26</span>, <span class="number">255</span>, <span class="number">161</span>, <span class="number">149</span>, <span class="number">54</span>, <span class="number">217</span>, <span class="number">235</span>, <span class="number">137</span>, <span class="number">227</span>, <span class="number">124</span>, <span class="number">115</span>, <span class="number">133</span>, <span class="number">136</span>, <span class="number">122</span>,</span><br><span class="line">        <span class="number">224</span>, <span class="number">253</span>, <span class="number">100</span>, <span class="number">12</span>, <span class="number">87</span>, <span class="number">50</span>, <span class="number">179</span>, <span class="number">185</span>, <span class="number">31</span>, <span class="number">215</span>, <span class="number">252</span>, <span class="number">129</span>, <span class="number">225</span>, <span class="number">2</span>, <span class="number">249</span>, <span class="number">93</span>, <span class="number">86</span>, <span class="number">111</span>, <span class="number">36</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">99</span>] = &#123;<span class="number">118</span>, <span class="number">53</span>, <span class="number">253</span>, <span class="number">245</span>, <span class="number">125</span>, <span class="number">71</span>, <span class="number">254</span>, <span class="number">149</span>, <span class="number">19</span>, <span class="number">122</span>, <span class="number">38</span>, <span class="number">89</span>, <span class="number">63</span>, <span class="number">255</span>, <span class="number">49</span>, <span class="number">161</span>, <span class="number">133</span>, <span class="number">124</span>, <span class="number">99</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">189</span>, <span class="number">147</span>, <span class="number">106</span>, <span class="number">62</span>, <span class="number">77</span>, <span class="number">141</span>, <span class="number">215</span>, <span class="number">39</span>, <span class="number">115</span>, <span class="number">45</span>, <span class="number">94</span>, <span class="number">204</span>, <span class="number">98</span>, <span class="number">242</span>, <span class="number">223</span>, <span class="number">229</span>, <span class="number">210</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> v7, v8;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + <span class="number">1</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">        v7 = box[j];</span><br><span class="line">        k = (k + v7) &amp; <span class="number">0xff</span>;</span><br><span class="line">        v8 = box[k];</span><br><span class="line">        box[j] = v8;</span><br><span class="line">        box[k] = v7;</span><br><span class="line">        ans[i] ^= (box[(v7 + v8) &amp; <span class="number">0xff</span>] &amp; <span class="number">0xff</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：e10adc3949ba59abbe56e057f20f883e</p>
<h2 id="WMCTF2020-easy-re"><a href="#WMCTF2020-easy-re" class="headerlink" title="[WMCTF2020]easy_re"></a>[WMCTF2020]easy_re</h2><p>本题采用没听过的perl语言编写，在通过perlapp编译。此类文件会在运行前先将代码解压，然后再执行。<br>再解压前会有script关键字，同时解压后的代码会存在rax中。通过x64dbg看到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BWMCTF2020%5Deasy_re1.png"><br>复制出来是一段perl的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$flag = <span class="string">&quot;WMCTF&#123;I_WAnt_dynam1c_F1ag&#125;&quot;</span>;</span><br><span class="line">print <span class="string">&quot;please input the flag:&quot;</span>;</span><br><span class="line">$line = &lt;STDIN&gt;;</span><br><span class="line"><span class="built_in">chomp</span>($line);</span><br><span class="line"><span class="keyword">if</span>($line eq $flag)&#123;</span><br><span class="line">        print <span class="string">&quot;congratulation!&quot;</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        print <span class="string">&quot;no,wrong&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：I_WAnt_dynam1c_F1ag</p>
<h2 id="CISCN2018-2ex"><a href="#CISCN2018-2ex" class="headerlink" title="[CISCN2018]2ex"></a>[CISCN2018]2ex</h2><p>魔改base64，但是题目给的输出多了一个”|”，不是很理解。<br>得到flag：change53233</p>
<h2 id="RoarCTF2019-polyre"><a href="#RoarCTF2019-polyre" class="headerlink" title="[RoarCTF2019]polyre"></a>[RoarCTF2019]polyre</h2><p>很牛逼的一道题。打开看见ollvm混淆，夹杂了控制流平坦化和虚假控制流。采用<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Clovershrub/p/17110043.html#_label2">脚本</a>去除后看见：<br>P.S.官方题解给出的debcf脚本在IDA7.7中已无法运行，需要自己更新一下，或者用我的。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BRoarCTF2019%5Dpolyre1.png"><br>可以看见它又一些莫名其妙地语句。整体算法发现是可逆的，如果数据大于0，执行后必定为偶数，否则必定为奇数。可以写出代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ans[<span class="number">10</span>] = &#123;<span class="number">0xbc8ff26d43536296</span>, <span class="number">0x520100780530ee16</span>, <span class="number">0x4dc0b5ea935f08ec</span>, <span class="number">0x342b90afd853f450</span>, <span class="number">0x8b250ebcaa2c3681</span>, <span class="number">0x55759f81a2c68ae4</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(ans[i] &amp; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ans[i] = (ans[i] ^ <span class="number">0xB0004B7679FA26B3</span>) / <span class="number">2</span>;</span><br><span class="line">                ans[i] |= <span class="number">0x8000000000000000</span>;                   <span class="comment">//强制给它置为负数</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                ans[i] /= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ans[i] &amp; <span class="number">0xff</span>);</span><br><span class="line">            ans[i] &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到flag：6ff29390-6c20-4c56-ba70-a95758e3d1f8</p>
<h2 id="watevrCTF-2019-Timeout"><a href="#watevrCTF-2019-Timeout" class="headerlink" title="[watevrCTF 2019]Timeout"></a>[watevrCTF 2019]Timeout</h2><p>通过010 editor或者exeinfoPE可以知道这家伙是一个elf文件。把.com后缀删掉拖到IDA里，然后翻一翻各种函数，可以找到flag。<br>得到flag：3ncrytion_is_overrated_youtube.com&#x2F;watch?v&#x3D;OPf0YbXqDm0</p>
<h2 id="SCTF2019-babyre"><a href="#SCTF2019-babyre" class="headerlink" title="[SCTF2019]babyre"></a>[SCTF2019]babyre</h2><p>非常傻逼的题目。<br>首先干掉4个花指令。<br>然后处理三组加密。第一个走迷宫，第二个硬爆破，第三个嗯逆。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//爆破</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> str[<span class="number">700</span>] = &#123;</span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">62</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">63</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">56</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">57</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">58</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">59</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">61</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">64</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">11</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">17</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">20</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">21</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">22</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">23</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">25</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">26</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">33</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">36</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">38</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">39</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">40</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">41</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">42</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">43</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">44</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">46</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">47</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">49</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">50</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> i, j, k, p, q, r;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">5</span>] = &#123;<span class="number">0x736374</span>, <span class="number">0x665f39</span>, <span class="number">0x313032</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">126</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(k = <span class="number">32</span>; k &lt; <span class="number">126</span>; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(p = <span class="number">32</span>; p &lt; <span class="number">126</span>; p++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span>(q = <span class="number">32</span>; q &lt; <span class="number">126</span>; q++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span>((((((str[j * <span class="number">4</span>] &amp; <span class="number">0x3f</span>) &lt;&lt; <span class="number">6</span>) | (str[k * <span class="number">4</span>] &amp; <span class="number">0x3f</span>)) &lt;&lt; <span class="number">6</span> | (str[p * <span class="number">4</span>] &amp; <span class="number">0x3f</span>)) &lt;&lt; <span class="number">6</span> | (str[q * <span class="number">4</span>] &amp; <span class="number">0x3f</span>)) == ans[i])</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span>(str[j * <span class="number">4</span>] != <span class="number">64</span> &amp;&amp; str[k * <span class="number">4</span>] != <span class="number">64</span> &amp;&amp; str[p * <span class="number">4</span>] != <span class="number">64</span> &amp;&amp; str[q * <span class="number">4</span>] != <span class="number">64</span>)</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, j, k, p, q);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//嗯逆</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> __ROL4__(<span class="type">unsigned</span> <span class="type">int</span> x, <span class="type">int</span> k)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &lt;&lt; k) | (x &gt;&gt; (<span class="number">32</span> - k));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> __ROR4__(<span class="type">unsigned</span> <span class="type">int</span> x, <span class="type">int</span> k)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt;&gt; k) | (x &lt;&lt; (<span class="number">32</span> - k));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> data[<span class="number">2000</span>] = &#123;</span><br><span class="line">    <span class="number">214</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">144</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">233</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">254</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">204</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">225</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">61</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">183</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">22</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">182</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">20</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">194</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">40</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">251</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">44</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">43</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">103</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">154</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">42</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">190</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">195</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">170</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">68</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">38</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">73</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">134</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">153</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">156</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">80</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">244</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">145</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">239</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">152</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">122</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">11</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">67</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">237</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">207</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">172</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">228</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">179</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">169</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">201</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">232</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">149</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">128</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">223</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">148</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">250</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">117</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">143</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">63</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">166</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">71</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">167</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">252</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">243</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">115</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">23</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">186</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">131</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">25</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">230</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">133</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">79</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">168</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">104</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">129</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">178</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">113</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">100</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">218</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">139</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">248</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">235</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">75</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">112</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">157</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">36</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">99</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">88</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">209</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">162</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">124</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">59</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">33</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">120</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">135</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">212</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">87</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">159</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">211</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">39</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">82</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">76</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">231</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">160</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">196</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">200</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">158</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">234</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">191</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">138</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">210</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">64</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">199</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">56</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">181</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">163</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">247</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">242</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">206</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">249</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">97</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">21</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">161</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">224</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">174</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">164</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">155</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">173</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">147</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">50</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">245</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">140</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">177</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">227</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">246</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">226</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">46</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">130</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">102</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">202</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">96</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">192</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">41</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">171</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">83</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">78</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">213</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">219</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">69</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">222</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">253</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">142</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">47</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">255</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">106</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">114</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">109</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">91</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">141</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">175</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">146</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">187</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">221</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">188</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">217</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">92</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">65</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">16</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">90</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">216</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">193</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">49</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">165</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">205</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">123</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">189</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">116</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">208</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">184</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">229</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">180</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">176</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">137</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">105</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">151</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">74</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">150</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">119</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">126</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">101</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">185</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">241</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">197</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">110</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">198</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">132</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">240</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">125</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">236</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">58</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">220</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">77</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">238</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">95</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">62</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">215</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">203</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">57</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">72</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">198</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">186</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">177</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">163</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">     <span class="number">80</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">170</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">151</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">145</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">125</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">103</span>,   <span class="number">0</span>, </span><br><span class="line">      <span class="number">0</span>,   <span class="number">0</span>, <span class="number">220</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">112</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">178</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> v2;</span><br><span class="line">    v2 = data[(x &amp; <span class="number">0xff</span>) * <span class="number">4</span>];</span><br><span class="line">    x &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    v2 |= data[(x &amp; <span class="number">0xff</span>) * <span class="number">4</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    x &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    v2 |= data[(x &amp; <span class="number">0xff</span>) * <span class="number">4</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    x &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    v2 |= data[(x &amp; <span class="number">0xff</span>) * <span class="number">4</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">return</span> __ROL4__(v2, <span class="number">12</span>) ^ (__ROL4__(v2, <span class="number">8</span>) ^ __ROR4__(v2, <span class="number">2</span>)) ^ __ROR4__(v2, <span class="number">6</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">20</span>];</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">190</span>;</span><br><span class="line">    ans[<span class="number">1</span>] = <span class="number">4</span>;</span><br><span class="line">    ans[<span class="number">2</span>] = <span class="number">6</span>;</span><br><span class="line">    ans[<span class="number">3</span>] = <span class="number">128</span>;</span><br><span class="line">    ans[<span class="number">4</span>] = <span class="number">197</span>;</span><br><span class="line">    ans[<span class="number">5</span>] = <span class="number">175</span>;</span><br><span class="line">    ans[<span class="number">6</span>] = <span class="number">118</span>;</span><br><span class="line">    ans[<span class="number">7</span>] = <span class="number">71</span>;</span><br><span class="line">    ans[<span class="number">8</span>] = <span class="number">159</span>;</span><br><span class="line">    ans[<span class="number">9</span>] = <span class="number">204</span>;</span><br><span class="line">    ans[<span class="number">10</span>] = <span class="number">64</span>;</span><br><span class="line">    ans[<span class="number">11</span>] = <span class="number">31</span>;</span><br><span class="line">    ans[<span class="number">12</span>] = <span class="number">216</span>;</span><br><span class="line">    ans[<span class="number">13</span>] = <span class="number">191</span>;</span><br><span class="line">    ans[<span class="number">14</span>] = <span class="number">146</span>;</span><br><span class="line">    ans[<span class="number">15</span>] = <span class="number">239</span>;</span><br><span class="line">    <span class="type">int</span> loop[<span class="number">50</span>];</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        loop[i] = (ans[<span class="number">12</span> - i * <span class="number">4</span>] &lt;&lt; <span class="number">24</span>) + (ans[<span class="number">12</span> - <span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">16</span>) + (ans[<span class="number">12</span> - i * <span class="number">4</span> + <span class="number">2</span>] &lt;&lt; <span class="number">8</span>) + ans[<span class="number">12</span> - i * <span class="number">4</span> + <span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">4</span>; i &lt; <span class="number">30</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        loop[i] = loop[i - <span class="number">4</span>] ^ <span class="built_in">func</span>(loop[i - <span class="number">3</span>] ^ loop[i - <span class="number">2</span>] ^ loop[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">29</span>; i &gt;= <span class="number">26</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, ((<span class="type">char</span>*)&amp;loop[i])[<span class="number">0</span>], ((<span class="type">char</span>*)&amp;loop[i])[<span class="number">1</span>], ((<span class="type">char</span>*)&amp;loop[i])[<span class="number">2</span>], ((<span class="type">char</span>*)&amp;loop[i])[<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font color = #ff0000>血的教训：写循环位移要定义成unsigned类型。不unsigned的话，右移时整数补0，负数补1，然后就错啦！</font><br>得到flag：ddwwxxssxaxwwaasasyywwdd-c2N0Zl85MTAy(fl4g_is_s0_ug1y!)</p>
<h2 id="ACTF新生赛2020-fungame"><a href="#ACTF新生赛2020-fungame" class="headerlink" title="[ACTF新生赛2020]fungame"></a>[ACTF新生赛2020]fungame</h2><p>题出的很好，下次别出了。<br>见面看到一个加密，这个很简单。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5Dfungame1.png"><br>解出来交上去就可以发现错啦！<br>看看下一个函数：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5Dfungame2.png"><br>这个函数很神奇，它把16字节的东西赋值给了12字节的空间，这会造成栈溢出。对，这其实是一个pwn题。<br>跟踪x可以发现<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5Dfungame3.png"><br>于是解得flag：Re_1s_So0_funny!&#x3D;#@a1s0_pWn</p>
<h2 id="羊城杯-2020-Bytecode"><a href="#羊城杯-2020-Bytecode" class="headerlink" title="[羊城杯 2020]Bytecode"></a>[羊城杯 2020]Bytecode</h2><p>傻逼python字节码，有种硬读汇编的美。抄一个脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">en = [<span class="number">3</span>, <span class="number">37</span>, <span class="number">72</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">132</span>]</span><br><span class="line">output = [<span class="number">101</span>, <span class="number">96</span>, <span class="number">23</span>, <span class="number">68</span>, <span class="number">112</span>, <span class="number">42</span>, <span class="number">107</span>, <span class="number">62</span>, <span class="number">96</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">179</span>, <span class="number">98</span>, <span class="number">53</span>, <span class="number">67</span>, <span class="number">29</span>, <span class="number">41</span>, <span class="number">120</span>, <span class="number">60</span>, <span class="number">106</span>, <span class="number">51</span>, <span class="number">101</span>, <span class="number">178</span>, <span class="number">189</span>, <span class="number">101</span>, <span class="number">48</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">s = Solver()</span><br><span class="line">a1 = Int(<span class="string">&#x27;a1&#x27;</span>)</span><br><span class="line">a2 = Int(<span class="string">&#x27;a2&#x27;</span>)</span><br><span class="line">a3 = Int(<span class="string">&#x27;a3&#x27;</span>)</span><br><span class="line">a4 = Int(<span class="string">&#x27;a4&#x27;</span>)</span><br><span class="line">a5 = Int(<span class="string">&#x27;a5&#x27;</span>)</span><br><span class="line">a6 = Int(<span class="string">&#x27;a6&#x27;</span>)</span><br><span class="line">s.add(a1 * <span class="number">3</span> + a2 * <span class="number">2</span> + a3 * <span class="number">5</span> == <span class="number">1003</span>)</span><br><span class="line">s.add(a1 * <span class="number">4</span> + a2 * <span class="number">7</span> + a3 * <span class="number">9</span> == <span class="number">2013</span>)</span><br><span class="line">s.add(a1 + a2 * <span class="number">8</span> + a3 * <span class="number">2</span> == <span class="number">1109</span>)</span><br><span class="line">s.add(a4 * <span class="number">3</span> + a5 * <span class="number">2</span> + a6 * <span class="number">5</span> == <span class="number">671</span>)</span><br><span class="line">s.add(a4 * <span class="number">4</span> + a5 * <span class="number">7</span> + a6 * <span class="number">9</span> == <span class="number">1252</span>)</span><br><span class="line">s.add(a4 + a5 * <span class="number">8</span> + a6 * <span class="number">2</span> == <span class="number">644</span>)</span><br><span class="line"><span class="keyword">if</span> s.check():</span><br><span class="line">    <span class="built_in">print</span>(s.model())</span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(output[k+<span class="number">1</span>] ^ en[i%<span class="number">6</span>])</span><br><span class="line">    flag += <span class="built_in">chr</span>(output[k] ^ en[i%<span class="number">6</span>])</span><br><span class="line">    k = k + <span class="number">2</span></span><br><span class="line">s = [<span class="number">97</span>, <span class="number">101</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">55</span>, <span class="number">51</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(s[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>得到flag：cfa2b87b3f746a8f0ac5c5963faeff73</p>
<h2 id="FlareOn2-very-success"><a href="#FlareOn2-very-success" class="headerlink" title="[FlareOn2]very_success"></a>[FlareOn2]very_success</h2><p>打开一看函数这么少还以为它加壳了呢，没想到它就是这么少。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BFlareOn2%5Dvery_success1.png"><br>逻辑很简单，通过动调可以发现v11始终为1。写出脚本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> Xor[<span class="number">100</span>] = &#123;</span><br><span class="line">    <span class="number">170</span>, <span class="number">236</span>, <span class="number">164</span>, <span class="number">186</span>, <span class="number">175</span>, <span class="number">174</span>, <span class="number">170</span>, <span class="number">138</span>, <span class="number">192</span>, <span class="number">167</span>, </span><br><span class="line">    <span class="number">176</span>, <span class="number">188</span>, <span class="number">154</span>, <span class="number">186</span>, <span class="number">165</span>, <span class="number">165</span>, <span class="number">186</span>, <span class="number">175</span>, <span class="number">184</span>, <span class="number">157</span>, </span><br><span class="line">    <span class="number">184</span>, <span class="number">249</span>, <span class="number">174</span>, <span class="number">157</span>, <span class="number">171</span>, <span class="number">180</span>, <span class="number">188</span>, <span class="number">182</span>, <span class="number">179</span>, <span class="number">144</span>, </span><br><span class="line">    <span class="number">154</span>, <span class="number">168</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> i, t = <span class="number">0</span>, last = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (Xor[<span class="number">32</span> - i - <span class="number">1</span>] - (<span class="number">1</span> &lt;&lt; (last &amp; <span class="number">3</span>)) - <span class="number">1</span>) ^ <span class="number">0xC7</span>);</span><br><span class="line">        last += Xor[<span class="number">32</span> - i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：<a href="mailto:&#97;&#95;&#76;&#x69;&#116;&#x74;&#108;&#101;&#95;&#x62;&#49;&#x74;&#x5f;&#104;&#97;&#114;&#100;&#x65;&#x72;&#x5f;&#x70;&#108;&#x65;&#122;&#x40;&#102;&#108;&#x61;&#114;&#101;&#x2d;&#x6f;&#x6e;&#x2e;&#99;&#x6f;&#x6d;">&#97;&#95;&#76;&#x69;&#116;&#x74;&#108;&#101;&#95;&#x62;&#49;&#x74;&#x5f;&#104;&#97;&#114;&#100;&#x65;&#x72;&#x5f;&#x70;&#108;&#x65;&#122;&#x40;&#102;&#108;&#x61;&#114;&#101;&#x2d;&#x6f;&#x6e;&#x2e;&#99;&#x6f;&#x6d;</a></p>
<h2 id="2019红帽杯-Snake"><a href="#2019红帽杯-Snake" class="headerlink" title="[2019红帽杯]Snake"></a>[2019红帽杯]Snake</h2><p>Unity3D的游戏，去找Assembly-CSharp.dll。可以看见他调用了一个外部的Interface.dll。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5DSnake1.png"><br>在Snake_Data&#x2F;Plugins文件夹下可以找到对应dll。用IDA打开，找到flag关键字的位置可以看见一坨非常抽象的东西，nnd看不懂一点。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5DSnake2.png"><br>去搜的大佬的博客知道这个东西可以爆破。python的ctypes库允许爆破dll文件中的特定函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    dll = ctypes.cdll.LoadLibrary(<span class="string">&quot;./Interface.dll&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    dll.GameObject(i)</span><br></pre></td></tr></table></figure>
<p>在地19次是可以得到flag：Ch4rp_W1th_R$@<br>从结果来看，这个b用C++写了一个RSA……只能说不愧是红帽杯……</p>
<h2 id="SCTF2019-Strange-apk"><a href="#SCTF2019-Strange-apk" class="headerlink" title="[SCTF2019]Strange apk"></a>[SCTF2019]Strange apk</h2><p>安卓的SMC。打开看见程序的入口点应该是sctf.demo.myapplication.t，但是找不到。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DStrangeapk1.png"><br>看见这个里面存在代码西修改的部分。它将data文件经过__()函数和_()函数解密(都tm什么函数名字)。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DStrangeapk2.png"><br>有用的解密代码部分：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DStrangeapk3.png"><br>写脚本运行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_byte</span>(<span class="params">v</span>):</span><br><span class="line">    <span class="keyword">return</span> v.to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    a = f.read()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sctf.apk&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> g:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">            g.write(get_byte(a[i] ^ <span class="built_in">ord</span>(<span class="string">&quot;syclover&quot;</span>[i % <span class="number">8</span>])))</span><br></pre></td></tr></table></figure>
<p>打开解密后的文件，这回找得到t部分了，但是看不懂。不过他总共就t、s、f三个有用的，找一找可以才出来加密的流程。下面这一部分在s里。前12个字符由f.sctf()函数加密。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DStrangeapk4.png"><br>后18个字符由f.encode()函数加密。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DStrangeapk5.png"><br>后半部分加密后的东西在t中<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DStrangeapk6.png"><br>挺离谱的，我不理解为什么会是这么个执行流程。看大佬的博客说跟安卓的父子组件通信机制有关。<br>得到flag：W3lc0me~t0_An4r0id-w0rld</p>
<h2 id="安洵杯-2019-game"><a href="#安洵杯-2019-game" class="headerlink" title="[安洵杯 2019]game"></a>[安洵杯 2019]game</h2><p>OLLVM代码混淆。用脚本除了trace()函数之外都可以反混淆。但是只有三个check函数是有意义的，其余的不用管它。<br>check1()函数对输入进行了一波操作：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5Dgame1.png"><br>check3()函数就是将输入复制到Dog3[]里再与sudoku[]对比。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5Dgame2.png"><br>因此，我们可以让程序运行起来，下断点之后将sudoku的内容提取出来。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF2019%5Dgame3.png"><br>接下来就是写一个脚本的过程：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> sudoku[<span class="number">81</span>] = &#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">int</span> Dog3[<span class="number">81</span>] = &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">int</span> input[<span class="number">81</span>] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> i, cnt = <span class="number">0</span>, tmp;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">81</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Dog3[i] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            input[cnt] = sudoku[i] + <span class="number">48</span>;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        input[i] += <span class="number">20</span>;</span><br><span class="line">        input[i] = (input[i] &amp; <span class="number">0xF3</span> | ~input[i] &amp; <span class="number">0xC</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; cnt; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp = input[i];</span><br><span class="line">        input[i] = input[i+<span class="number">1</span>];</span><br><span class="line">        input[i+<span class="number">1</span>] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp = input[i];</span><br><span class="line">        input[i] = input[cnt];</span><br><span class="line">        input[cnt] = tmp;</span><br><span class="line">        cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, input[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行脚本得到flag：KDEEIFGKIJ@AFGEJAEF@FDKADFGIJFA@FDE@JG@J</p>
<h2 id="GWCTF-2019-babyvm"><a href="#GWCTF-2019-babyvm" class="headerlink" title="[GWCTF 2019]babyvm"></a>[GWCTF 2019]babyvm</h2><p>最瞧不起这种真flag在本地打不通，但假flag能打通的题目。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BGWCTF2019%5Dbabyvm1.png"><br>传统虚拟机逆向。尽管它在执行VMrun函数的时候会跳转到VMrun_another函数很神奇，但并不影响我瞧不起它。我觉得很奇怪，你明明能做到这个，为什么不将VMrun_another函数改成真正需要选手破解的那一段。然后再把VMcheck执行的时候用同样的技术跳转到VMcheck_another函数。这样不就是一个在本地能打通的题目了？？？<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BGWCTF2019%5Dbabyvm2.png"><br>没什么可说的，解题脚本如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> enc[<span class="number">30</span>] = &#123;<span class="number">105</span>,  <span class="number">69</span>,  <span class="number">42</span>,  <span class="number">55</span>,   <span class="number">9</span>,  <span class="number">23</span>, <span class="number">197</span>,  <span class="number">11</span>,  <span class="number">92</span>, <span class="number">114</span>,  <span class="number">51</span>, <span class="number">118</span>,  <span class="number">51</span>,  <span class="number">33</span>, <span class="number">116</span>,  <span class="number">49</span>,  <span class="number">95</span>,  <span class="number">51</span>, <span class="number">115</span>, <span class="number">114</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i, j, tmp;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">13</span>; i &lt;= <span class="number">15</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp = enc[i];</span><br><span class="line">        enc[i] = enc[<span class="number">32</span>-i];</span><br><span class="line">        enc[<span class="number">32</span>-i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">8</span>; i &gt;= <span class="number">6</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((((j*<span class="number">3</span> + enc[i+<span class="number">1</span>]*<span class="number">2</span> + enc[i+<span class="number">2</span>]) * enc[<span class="number">12</span>]) &amp; <span class="number">0xff</span>) == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                enc[i] = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">5</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        enc[i] ^= enc[i+<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到flag：Y0u_hav3_r3v3rs3_1t!</p>
<h2 id="网鼎杯-2020-青龙组-bang"><a href="#网鼎杯-2020-青龙组-bang" class="headerlink" title="[网鼎杯 2020 青龙组]bang"></a>[网鼎杯 2020 青龙组]bang</h2><p>安卓脱壳。<br>使用<a href="/file/detect_shell_name.zip">这个脚本</a>查壳，然后使用模拟器和frida脱壳。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84%5Dbang1.png"><br>脱壳后会生成两个dex文件，使用dex2jar工具将其转为jar文件。再使用jadx-jui打开jar文件。<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84%5Dbang2.png"><br>可以找到flag：borring_things</p>
<h2 id="SUCTF2018-babyre"><a href="#SUCTF2018-babyre" class="headerlink" title="[SUCTF2018]babyre"></a>[SUCTF2018]babyre</h2><p>这个题不好评价。输入key，正确的key会吐出flag。直接爆破。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> v7[<span class="number">240</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">28</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">28</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">31</span>, <span class="number">36</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">39</span>, <span class="number">36</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">46</span>, <span class="number">43</span>, <span class="number">36</span>, <span class="number">45</span>, <span class="number">38</span>, <span class="number">47</span>, <span class="number">56</span>, <span class="number">49</span>, <span class="number">58</span>, <span class="number">59</span>, <span class="number">52</span>, <span class="number">61</span>, <span class="number">62</span>, <span class="number">55</span>, <span class="number">48</span>, <span class="number">57</span>, <span class="number">50</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">66</span>, <span class="number">66</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">70</span>, <span class="number">71</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">74</span>, <span class="number">74</span>, <span class="number">77</span>, <span class="number">77</span>, <span class="number">79</span>, <span class="number">78</span>, <span class="number">80</span>, <span class="number">80</span>, <span class="number">82</span>, <span class="number">83</span>, <span class="number">85</span>, <span class="number">84</span>, <span class="number">86</span>, <span class="number">87</span>, <span class="number">89</span>, <span class="number">89</span>, <span class="number">90</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">93</span>, <span class="number">94</span>, <span class="number">94</span>, <span class="number">96</span>, <span class="number">96</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">103</span>, <span class="number">103</span>, <span class="number">105</span>, <span class="number">105</span>, <span class="number">107</span>, <span class="number">107</span>, <span class="number">108</span>, <span class="number">109</span>, <span class="number">110</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">117</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">123</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">125</span>, <span class="number">127</span>, <span class="number">127</span>, <span class="number">-127</span>, <span class="number">-127</span>, <span class="number">-125</span>, <span class="number">-125</span>, <span class="number">-116</span>, <span class="number">-115</span>, <span class="number">-114</span>, <span class="number">-113</span>, <span class="number">-120</span>, <span class="number">-119</span>, <span class="number">-118</span>, <span class="number">-117</span>, <span class="number">-116</span>, <span class="number">-115</span>, <span class="number">-114</span>, <span class="number">-121</span>, <span class="number">-104</span>, <span class="number">-111</span>, <span class="number">-110</span>, <span class="number">-109</span>, <span class="number">-108</span>, <span class="number">-107</span>, <span class="number">-106</span>, <span class="number">-105</span>, <span class="number">-104</span>, <span class="number">-103</span>, <span class="number">-102</span>, <span class="number">-102</span>, <span class="number">-100</span>, <span class="number">-100</span>, <span class="number">-98</span>, <span class="number">-98</span>, <span class="number">-96</span>, <span class="number">-96</span>, <span class="number">-94</span>, <span class="number">-94</span>, <span class="number">-92</span>, <span class="number">-92</span>, <span class="number">-90</span>, <span class="number">-90</span>, <span class="number">-88</span>, <span class="number">-88</span>, <span class="number">-86</span>, <span class="number">-86</span>, <span class="number">-84</span>, <span class="number">-84</span>, <span class="number">-82</span>, <span class="number">-82</span>, <span class="number">-80</span>, <span class="number">-79</span>, <span class="number">-78</span>, <span class="number">-77</span>&#125;;</span><br><span class="line">    <span class="type">int</span> key, j, v12, v13;</span><br><span class="line">    <span class="type">int</span> v9[<span class="number">60</span>];</span><br><span class="line">    <span class="keyword">for</span>(key = <span class="number">0</span>; key &lt;= <span class="number">0x10000</span>; key++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">30</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            v9[j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v9[<span class="number">30</span>] = <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">while</span>(v9[<span class="number">30</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            --v9[<span class="number">30</span>];</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">22</span>; j; v9[j] = (v9[j] | (v13 &lt;&lt; v9[<span class="number">30</span>])) &amp; <span class="number">0xff</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                v12 = v7[<span class="number">22</span> * v9[<span class="number">30</span>] + --j];</span><br><span class="line">                v13 = (v12 &gt;&gt; ((key &gt;&gt; (<span class="number">2</span> * v9[<span class="number">30</span>])) &amp; <span class="number">3</span>)) &amp; <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(v9[<span class="number">0</span>] == <span class="string">&#x27;S&#x27;</span> &amp;&amp; v9[<span class="number">1</span>] == <span class="string">&#x27;U&#x27;</span> &amp;&amp; v9[<span class="number">2</span>] == <span class="string">&#x27;C&#x27;</span> &amp;&amp; v9[<span class="number">3</span>] == <span class="string">&#x27;T&#x27;</span> &amp;&amp; v9[<span class="number">4</span>] == <span class="string">&#x27;F&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">30</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, v9[j]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到flag：Flag_8i7244980f</p>
<h2 id="HDCTF2019-MFC"><a href="#HDCTF2019-MFC" class="headerlink" title="[HDCTF2019]MFC"></a>[HDCTF2019]MFC</h2><p>好神奇的东西。看见vmp壳的时候想着可以学学怎么脱了，然后一搜发现都是在教怎么破mfc。没事，反正mfc也没见过。<br>运行程序看见：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BHDCTF2019%5DMFC1.png"><br>将xspy的放大镜拖到这个框上面可以得到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BHDCTF2019%5DMFC2.png"><br>发现其中的0x0464这条消息不是系统的，写脚本发送消息。此处要用Visual Studio。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HWND h = <span class="built_in">FindWindow</span>(<span class="number">0</span>, <span class="string">&quot;Flag就在控件里&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (h != <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">SendMessageA</span>(h, <span class="number">0x464</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;failure&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之后得到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BHDCTF2019%5DMFC3.png"><br>将xspy上方的数据拿出来解DES可以得到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BHDCTF2019%5DMFC4.png"><br>可以得到flag：thIs_Is_real_kEy_hahaaa</p>
<h2 id="BSidesSF2019-blink"><a href="#BSidesSF2019-blink" class="headerlink" title="[BSidesSF2019]blink"></a>[BSidesSF2019]blink</h2><p>拖到jadx中，在r2d2方法里找到base64，解出来转成图片：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BBSidesSF2019%5Dblink.jpeg"><br>用JEB的话它会吞掉一部分字符串，用<code>[...]</code>代替，很傻逼。<br>得到flag：PUCKMAN</p>
<h2 id="SCTF2019-creakme"><a href="#SCTF2019-creakme" class="headerlink" title="[SCTF2019]creakme"></a>[SCTF2019]creakme</h2><p>做的时候很痛苦，做完了觉得痛苦的原因应该还是自己太菜了。。。<br>打开看见：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5Dcreakme1.png"><br>值得关注的是sub_402320()和sub_4024A0()。首先看sub_402420()：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5Dcreakme2.png"><br>可以发现程序自己使用DebugBreak陷入异常，同时使用SEH执行sub_402450()。<br>再看sub_4024A0()，这个函数将某一段数据作为代码执行了，可以推测sub_402320()是在做相应的SMC。反正没到输入，修改后的代码在干啥其实不用管。<br>将这两个函数中的反调试跳转语句稍作修改，再动调并根据FindCrypt插件我们可以发现encrypt()函数中的AES和Base64：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5Dcreakme3.png"><br>这时我们可以发现原先的对比数据<code>&gt;pvfqYc,4tTc2UxRmlJ,sB&#123;Fh4Ck2:CFOb4ErhtIcoLo</code><br>变成了<code>nKnbHsgqD3aNEB91jB3gEzAr+IklQwT1bSs3+bXpeuo=</code><br>然后我们就可以请出CyberChef了：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5Dcreakme4.png"><br>BAKE得到flag：Ae3_C8c_I28_pKcs79ad4</p>
<h2 id="MRCTF2020-EasyCpp"><a href="#MRCTF2020-EasyCpp" class="headerlink" title="[MRCTF2020]EasyCpp"></a>[MRCTF2020]EasyCpp</h2><p>只能说，不愧是CPP。<br>整个程序没有添加各种奇奇怪怪的东西，只看main即可。先看这一部分：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BMRCTF2020%5DEasyCpp1.png"><br>总结一下就是它输入了9个int数。这道题它虽然用到了vector，但是并没有做什么有关vector的高级操作，完全可以用数组代替。<br>然后是接下来的加密部分：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BMRCTF2020%5DEasyCpp2.png"><br>代码挺神奇的，还是第一次知道lambda表达式在程序里面长这个样子。要注意depart()函数拆完后拼接的时，会在每一个质数前加一个空格。这也就是为什么要对比的数据里面有很多等于号。开始做的时候没注意这一点，于是就在不停地想，它到底是怎么把数字给弄成空格的。。。<br>然后是对比部分，可以动调一下找到：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BMRCTF2020%5DEasyCpp3.png"><br>数据量不大，手搓就行了，然后异或1回去，得到<code>2345 1222 5774 2476 3374 9032 2456 3531 6720</code>，再输入给程序。<br>运行程序得到flag：4367FB5F42C6E46B2AF79BF409FB84D3</p>
<h2 id="SCTF2019-Who-is-he"><a href="#SCTF2019-Who-is-he" class="headerlink" title="[SCTF2019]Who is he"></a>[SCTF2019]Who is he</h2><p>挺神奇的一道题，不是很理解它怎么做到的，网上也没能搜到相应的解释。<br>常规地，进入Assembly-CSharp.dll查找相关代码，很简单的base64+DES。<br>解出<code>He_P1ay_Basketball_Very_We11!Hahahahaha!</code>但提交发现这是错的。<br>用CheatEngine可以搜索到额外的几组密文：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BSCTF2019%5DWhoishe.png"><br>写一个解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;t\x00e\x00s\x00t\x00&quot;</span></span><br><span class="line">des = DES.new(key, mode = DES.MODE_CBC, iv = key)</span><br><span class="line">cipher = <span class="string">b&quot;78 00 5A 00 57 00 44 00 5A 00 61 00 4B 00 45 00 68 00 57 00 4E 00 4D 00 43 00 62 00 69 00 47 00 59 00 50 00 42 00 49 00 6C 00 59 00 33 00 2B 00 61 00 72 00 6F 00 7A 00 4F 00 39 00 7A 00 6F 00 6E 00 77 00 72 00 59 00 4C 00 69 00 56 00 4C 00 34 00 6E 00 6A 00 53 00 65 00 7A 00 32 00 52 00 59 00 4D 00 32 00 57 00 77 00 73 00 47 00 6E 00 73 00 6E 00 6A 00 43 00 44 00 6E 00 48 00 73 00 37 00 4E 00 34 00 33 00 61 00 46 00 76 00 4E 00 45 00 35 00 34 00 6E 00 6F 00 53 00 61 00 64 00 50 00 39 00 46 00 38 00 65 00 45 00 70 00 76 00 54 00 73 00 35 00 51 00 50 00 47 00 2B 00 4B 00 4C 00 30 00 54 00 44 00 45 00 2F 00 34 00 30 00 6E 00 62 00 55 00 3D 00&quot;</span></span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher), <span class="number">6</span>):</span><br><span class="line">    <span class="keyword">if</span> cipher[i] &gt;= <span class="number">48</span> <span class="keyword">and</span> cipher[i] &lt;= <span class="number">57</span>:</span><br><span class="line">        t = (cipher[i] - <span class="number">48</span>) * <span class="number">16</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t = (cipher[i] - <span class="number">65</span> + <span class="number">10</span>) * <span class="number">16</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i+<span class="number">1</span>] &gt;= <span class="number">48</span> <span class="keyword">and</span> cipher[i+<span class="number">1</span>] &lt;= <span class="number">57</span>:</span><br><span class="line">        t += cipher[i+<span class="number">1</span>] - <span class="number">48</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t += cipher[i+<span class="number">1</span>] - <span class="number">65</span> + <span class="number">10</span></span><br><span class="line">    c += <span class="built_in">chr</span>(t).encode()</span><br><span class="line"></span><br><span class="line">cipher = base64.b64decode(c)</span><br><span class="line">plain = des.decrypt(cipher)[<span class="number">0</span>:-<span class="number">6</span>].decode(<span class="string">&quot;utf-16&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure>
<p>解得flag：She_P1ay_Black_Hole_Very_Wel1!LOL!XD!<br>不知道它是怎么把这些东西藏起来的。。。</p>
<h2 id="NPUCTF2020-Baby-Obfuscation"><a href="#NPUCTF2020-Baby-Obfuscation" class="headerlink" title="[NPUCTF2020]Baby Obfuscation"></a>[NPUCTF2020]Baby Obfuscation</h2><p>看题目名字我还以为能够用脚本一把梭呢。。。结果是做着自己写的混淆。。。<br>整个代码分析一遍可以得到下面的样子：<br><img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3/%5BNPUCTF2020%5DBabyObfuscation.png"><br>其中A_minus_B()函数非常有意思，<code>~(~a + b)</code>等价于<code>a-b</code><br>然后就可以写出解题脚本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> data[<span class="number">20</span>] = &#123;<span class="number">0</span>, <span class="number">7801</span>, <span class="number">7801</span>, <span class="number">8501</span>, <span class="number">5901</span>, <span class="number">8001</span>, <span class="number">6401</span>, <span class="number">11501</span>, <span class="number">4601</span>, <span class="number">9801</span>, <span class="number">9601</span>, <span class="number">11701</span>, <span class="number">5301</span>, <span class="number">9701</span>, <span class="number">10801</span>, <span class="number">12501</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> A0X4[<span class="number">5</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        data[i] = (data[i] - <span class="number">1</span>) / <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        data[i] /= <span class="number">10</span>;</span><br><span class="line">        data[i] ^= A0X4[(i<span class="number">-1</span>) % <span class="number">4</span>];</span><br><span class="line">        data[i] = ~((~data[i]) - A0X4[(i<span class="number">-1</span>) % <span class="number">4</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到flag：0bfu5er</p>
<h2 id="NPUCTF2020-BasicASM"><a href="#NPUCTF2020-BasicASM" class="headerlink" title="[NPUCTF2020]BasicASM"></a>[NPUCTF2020]BasicASM</h2><p>纯汇编，还是CPP的汇编。。。没什么技术含量。。。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> ans[<span class="number">100</span>] = <span class="string">&quot;662e61257b26301d7972751d6b2c6f355f3a38742d74341d61776d7d7d&quot;</span>;</span><br><span class="line">    <span class="type">int</span> data[<span class="number">50</span>];</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(ans) / <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        data[i] = (ans[i*<span class="number">2</span>] &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ans[i*<span class="number">2</span>] &lt;= <span class="string">&#x27;9&#x27;</span>) ? ans[i*<span class="number">2</span>] - <span class="string">&#x27;0&#x27;</span> : ans[i*<span class="number">2</span>] - <span class="string">&#x27;a&#x27;</span> + <span class="number">10</span>;</span><br><span class="line">        data[i] = (data[i] * <span class="number">16</span>) + ((ans[i*<span class="number">2</span>+<span class="number">1</span>] &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ans[i*<span class="number">2</span>+<span class="number">1</span>] &lt;= <span class="string">&#x27;9&#x27;</span>) ? ans[i*<span class="number">2</span>+<span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span> : ans[i*<span class="number">2</span>+<span class="number">1</span>] - <span class="string">&#x27;a&#x27;</span> + <span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span>(i &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            data[i] ^= <span class="number">0x42</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行得到flag：d0_y0u_know_x86-64_a5m?</p>
<h2 id="ACTF新生赛2020-Splendid-MineCraft"><a href="#ACTF新生赛2020-Splendid-MineCraft" class="headerlink" title="[ACTF新生赛2020]Splendid_MineCraft"></a>[ACTF新生赛2020]Splendid_MineCraft</h2><p>一个劲往下动调就行了。加了有SMC，再加上跳转是依靠jmp寄存器进行的，伪代码可读性其实不高，不如汇编流程图来得实在。可以写出这么个代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ACTF&#123;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> v3[<span class="number">10</span>] = <span class="string">&quot;Welcome &quot;</span>;</span><br><span class="line">    <span class="type">char</span> v4[<span class="number">10</span>] = <span class="string">&quot;3@1b;b&quot;</span>;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (v3[i+<span class="number">1</span>] ^ v4[i]) + <span class="number">35</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;_&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> data[<span class="number">0x100</span>] = &#123;<span class="number">246</span>, <span class="number">163</span>,  <span class="number">91</span>, <span class="number">157</span>, <span class="number">224</span>, <span class="number">149</span>, <span class="number">152</span>, <span class="number">104</span>, <span class="number">140</span>, <span class="number">101</span>, <span class="number">187</span>, <span class="number">118</span>, <span class="number">137</span>, <span class="number">212</span>,   <span class="number">9</span>, <span class="number">253</span>, <span class="number">243</span>,  <span class="number">92</span>,  <span class="number">60</span>,  <span class="number">76</span>,  <span class="number">54</span>, <span class="number">142</span>,  <span class="number">77</span>, <span class="number">196</span>, <span class="number">128</span>,  <span class="number">68</span>, <span class="number">214</span>, <span class="number">169</span>,   <span class="number">1</span>,  <span class="number">50</span>, <span class="number">119</span>,  <span class="number">41</span>, <span class="number">144</span>, <span class="number">188</span>, <span class="number">192</span>, <span class="number">168</span>, <span class="number">216</span>, <span class="number">249</span>, <span class="number">225</span>,  <span class="number">29</span>, <span class="number">228</span>, <span class="number">103</span>, <span class="number">125</span>,  <span class="number">42</span>,  <span class="number">44</span>,  <span class="number">89</span>, <span class="number">158</span>,  <span class="number">61</span>, <span class="number">122</span>,  <span class="number">52</span>,  <span class="number">17</span>,  <span class="number">67</span>, <span class="number">116</span>, <span class="number">209</span>,  <span class="number">98</span>,  <span class="number">96</span>,   <span class="number">2</span>,  <span class="number">75</span>, <span class="number">174</span>, <span class="number">153</span>,  <span class="number">87</span>, <span class="number">198</span>, <span class="number">115</span>, <span class="number">176</span>,  <span class="number">51</span>,  <span class="number">24</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">185</span>, <span class="number">133</span>, <span class="number">182</span>, <span class="number">217</span>, <span class="number">222</span>, <span class="number">123</span>, <span class="number">207</span>,  <span class="number">79</span>, <span class="number">179</span>, <span class="number">213</span>,   <span class="number">8</span>, <span class="number">124</span>,  <span class="number">10</span>, <span class="number">113</span>,  <span class="number">18</span>,   <span class="number">6</span>,  <span class="number">55</span>, <span class="number">255</span>, <span class="number">127</span>, <span class="number">183</span>,  <span class="number">70</span>,  <span class="number">66</span>,  <span class="number">37</span>, <span class="number">201</span>, <span class="number">208</span>,  <span class="number">80</span>,  <span class="number">82</span>, <span class="number">206</span>, <span class="number">189</span>, <span class="number">108</span>, <span class="number">229</span>, <span class="number">111</span>, <span class="number">165</span>,  <span class="number">21</span>, <span class="number">237</span>, <span class="number">100</span>, <span class="number">240</span>,  <span class="number">35</span>,  <span class="number">53</span>, <span class="number">231</span>,  <span class="number">12</span>,  <span class="number">97</span>, <span class="number">164</span>, <span class="number">215</span>,  <span class="number">81</span>, <span class="number">117</span>, <span class="number">154</span>, <span class="number">242</span>,  <span class="number">30</span>, <span class="number">235</span>,  <span class="number">88</span>, <span class="number">241</span>, <span class="number">148</span>, <span class="number">195</span>,  <span class="number">47</span>,  <span class="number">86</span>, <span class="number">247</span>, <span class="number">230</span>, <span class="number">134</span>,  <span class="number">71</span>, <span class="number">251</span>, <span class="number">131</span>,  <span class="number">94</span>, <span class="number">204</span>,  <span class="number">33</span>,  <span class="number">74</span>,  <span class="number">36</span>,   <span class="number">7</span>,  <span class="number">28</span>, <span class="number">138</span>,  <span class="number">90</span>,  <span class="number">23</span>,  <span class="number">27</span>, <span class="number">218</span>, <span class="number">236</span>,  <span class="number">56</span>,  <span class="number">14</span>, <span class="number">126</span>, <span class="number">180</span>,  <span class="number">72</span>, <span class="number">136</span>, <span class="number">244</span>, <span class="number">184</span>,  <span class="number">39</span>, <span class="number">145</span>,   <span class="number">0</span>,  <span class="number">19</span>, <span class="number">151</span>, <span class="number">190</span>,  <span class="number">83</span>, <span class="number">194</span>, <span class="number">232</span>, <span class="number">234</span>,  <span class="number">26</span>, <span class="number">233</span>,  <span class="number">45</span>,  <span class="number">20</span>,  <span class="number">11</span>, <span class="number">191</span>, <span class="number">181</span>,  <span class="number">64</span>, <span class="number">121</span>, <span class="number">210</span>,  <span class="number">62</span>,  <span class="number">25</span>,  <span class="number">93</span>, <span class="number">248</span>, <span class="number">105</span>,  <span class="number">57</span>,  <span class="number">95</span>, <span class="number">219</span>, <span class="number">250</span>, <span class="number">178</span>, <span class="number">139</span>, <span class="number">110</span>, <span class="number">162</span>, <span class="number">223</span>,  <span class="number">22</span>, <span class="number">226</span>,  <span class="number">99</span>, <span class="number">177</span>,  <span class="number">32</span>, <span class="number">203</span>, <span class="number">186</span>, <span class="number">238</span>, <span class="number">141</span>, <span class="number">170</span>, <span class="number">200</span>, <span class="number">199</span>, <span class="number">197</span>,   <span class="number">5</span>, <span class="number">102</span>, <span class="number">109</span>,  <span class="number">58</span>,  <span class="number">69</span>, <span class="number">114</span>,  <span class="number">13</span>, <span class="number">202</span>, <span class="number">132</span>,  <span class="number">78</span>, <span class="number">245</span>,  <span class="number">49</span>, <span class="number">107</span>, <span class="number">146</span>, <span class="number">220</span>, <span class="number">221</span>, <span class="number">156</span>,  <span class="number">63</span>,  <span class="number">85</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">159</span>, <span class="number">205</span>, <span class="number">155</span>, <span class="number">227</span>, <span class="number">160</span>, <span class="number">167</span>, <span class="number">252</span>, <span class="number">193</span>, <span class="number">120</span>,  <span class="number">16</span>,  <span class="number">46</span>, <span class="number">130</span>, <span class="number">143</span>,  <span class="number">48</span>,  <span class="number">84</span>,   <span class="number">4</span>, <span class="number">172</span>,  <span class="number">65</span>, <span class="number">147</span>, <span class="number">211</span>,  <span class="number">59</span>, <span class="number">239</span>,   <span class="number">3</span>, <span class="number">129</span>, <span class="number">112</span>, <span class="number">166</span>,  <span class="number">31</span>,  <span class="number">34</span>,  <span class="number">38</span>,  <span class="number">40</span>, <span class="number">106</span>, <span class="number">171</span>, <span class="number">135</span>, <span class="number">173</span>,  <span class="number">73</span>,  <span class="number">15</span>, <span class="number">175</span>&#125;;</span><br><span class="line">    <span class="type">int</span> num[<span class="number">10</span>] = &#123;<span class="number">48</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">48</span>, <span class="number">99</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">0x100</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(data[j] == num[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j ^ (i + <span class="number">0x83</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;_5mcsM&lt;&#125;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：yOu0y*_knowo3_5mcsM&lt;</p>
</article><div class="tag_share"><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/08/06/BUUCTF%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E-1/" title="BUUCTF二进制漏洞-1"><img class="cover" src="/img/BUUCTF%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E-1/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">BUUCTF二进制漏洞-1</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/23/%E6%8C%87%E9%92%88%E4%B8%8E%E9%93%BE%E8%A1%A8/" title="指针与链表"><img class="cover" src="/img/%E6%8C%87%E9%92%88%E4%B8%8E%E9%93%BE%E8%A1%A8/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">指针与链表</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/blogs/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Clovershrub</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-3"><span class="toc-text">BUUCTF逆向工程-3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-childRE"><span class="toc-text">[2019红帽杯]childRE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SWPU2019-ReverseMe"><span class="toc-text">[SWPU2019]ReverseMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-login"><span class="toc-text">[羊城杯 2020]login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QCTF2018-Xman-babymips"><span class="toc-text">[QCTF2018]Xman-babymips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-crackMe"><span class="toc-text">[安洵杯 2019]crackMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTCTF2020-babymips"><span class="toc-text">[UTCTF2020]babymips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GKCTF-2021-QQQQT"><span class="toc-text">[GKCTF 2021]QQQQT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-%E4%BD%A0%E5%A5%BDsao%E5%95%8A"><span class="toc-text">[NPUCTF2020]你好sao啊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-funnyre"><span class="toc-text">[WUSTCTF2020]funnyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUET-CTF2019-encrypt"><span class="toc-text">[GUET-CTF2019]encrypt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WMCTF2020-easy-re"><span class="toc-text">[WMCTF2020]easy_re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCN2018-2ex"><span class="toc-text">[CISCN2018]2ex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF2019-polyre"><span class="toc-text">[RoarCTF2019]polyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watevrCTF-2019-Timeout"><span class="toc-text">[watevrCTF 2019]Timeout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SCTF2019-babyre"><span class="toc-text">[SCTF2019]babyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-fungame"><span class="toc-text">[ACTF新生赛2020]fungame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-Bytecode"><span class="toc-text">[羊城杯 2020]Bytecode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlareOn2-very-success"><span class="toc-text">[FlareOn2]very_success</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-Snake"><span class="toc-text">[2019红帽杯]Snake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SCTF2019-Strange-apk"><span class="toc-text">[SCTF2019]Strange apk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-game"><span class="toc-text">[安洵杯 2019]game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GWCTF-2019-babyvm"><span class="toc-text">[GWCTF 2019]babyvm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-bang"><span class="toc-text">[网鼎杯 2020 青龙组]bang</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2018-babyre"><span class="toc-text">[SUCTF2018]babyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HDCTF2019-MFC"><span class="toc-text">[HDCTF2019]MFC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BSidesSF2019-blink"><span class="toc-text">[BSidesSF2019]blink</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SCTF2019-creakme"><span class="toc-text">[SCTF2019]creakme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-EasyCpp"><span class="toc-text">[MRCTF2020]EasyCpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SCTF2019-Who-is-he"><span class="toc-text">[SCTF2019]Who is he</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-Baby-Obfuscation"><span class="toc-text">[NPUCTF2020]Baby Obfuscation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-BasicASM"><span class="toc-text">[NPUCTF2020]BasicASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Splendid-MineCraft"><span class="toc-text">[ACTF新生赛2020]Splendid_MineCraft</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/01/26/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B/" title="傀儡进程"><img src="/img/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="傀儡进程"/></a><div class="content"><a class="title" href="/2024/01/26/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B/" title="傀儡进程">傀儡进程</a><time datetime="2024-01-25T16:00:00.000Z" title="Created 2024-01-26 00:00:00">2024-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/23/COM%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/" title="COM劫持实现提权"><img src="/img/COM%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="COM劫持实现提权"/></a><div class="content"><a class="title" href="/2024/01/23/COM%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/" title="COM劫持实现提权">COM劫持实现提权</a><time datetime="2024-01-22T16:00:00.000Z" title="Created 2024-01-23 00:00:00">2024-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/28/pwn%E4%BD%A0%E5%A6%88/" title="pwn你妈"><img src="/img/pwn%E4%BD%A0%E5%A6%88/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwn你妈"/></a><div class="content"><a class="title" href="/2023/11/28/pwn%E4%BD%A0%E5%A6%88/" title="pwn你妈">pwn你妈</a><time datetime="2023-11-27T16:00:00.000Z" title="Created 2023-11-28 00:00:00">2023-11-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/25/%5BTSCTF-J2023%5D%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E9%A2%98%E8%A7%A3/" title="[TSCTF-J2023]逆向工程题解"><img src="/img/%5BTSCTF-J2023%5D%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E9%A2%98%E8%A7%A3/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[TSCTF-J2023]逆向工程题解"/></a><div class="content"><a class="title" href="/2023/09/25/%5BTSCTF-J2023%5D%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E9%A2%98%E8%A7%A3/" title="[TSCTF-J2023]逆向工程题解">[TSCTF-J2023]逆向工程题解</a><time datetime="2023-09-24T16:00:00.000Z" title="Created 2023-09-25 00:00:00">2023-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/06/BUUCTF%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E-1/" title="BUUCTF二进制漏洞-1"><img src="/img/BUUCTF%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E-1/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF二进制漏洞-1"/></a><div class="content"><a class="title" href="/2023/08/06/BUUCTF%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E-1/" title="BUUCTF二进制漏洞-1">BUUCTF二进制漏洞-1</a><time datetime="2023-08-05T16:00:00.000Z" title="Created 2023-08-06 00:00:00">2023-08-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/blogs/foot.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Clovershrub</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="255,0,150" opacity="0.7" zIndex="-1" count="200" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>