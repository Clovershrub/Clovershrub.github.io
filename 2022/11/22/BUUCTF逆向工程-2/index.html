<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BUUCTF逆向工程-2 | Clovershrub</title><meta name="author" content="Clovershrub"><meta name="copyright" content="Clovershrub"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="BUUCTF逆向工程-2 相册 打开后可以找到发送邮件的函数原型：  根据交叉引用找到调用它的地方：  可以知道C2.MAILSERVER应当为邮箱，根据交叉引用可以找到：  这个函数加载了一个core文件，然后调用里面的NativeMethod.m()函数，查看它的Library：  有一个libcore.so文件，将它用IDA打开，在java_com_net_cn_NativeMethod_m">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF逆向工程-2">
<meta property="og:url" content="https://clovershrub.github.io/2022/11/22/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/index.html">
<meta property="og:site_name" content="Clovershrub">
<meta property="og:description" content="BUUCTF逆向工程-2 相册 打开后可以找到发送邮件的函数原型：  根据交叉引用找到调用它的地方：  可以知道C2.MAILSERVER应当为邮箱，根据交叉引用可以找到：  这个函数加载了一个core文件，然后调用里面的NativeMethod.m()函数，查看它的Library：  有一个libcore.so文件，将它用IDA打开，在java_com_net_cn_NativeMethod_m">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://clovershrub.github.io/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/cover.png">
<meta property="article:published_time" content="2022-11-21T16:00:00.000Z">
<meta property="article:modified_time" content="2023-09-19T04:57:42.409Z">
<meta property="article:author" content="Clovershrub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://clovershrub.github.io/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/cover.png"><link rel="shortcut icon" href="/img/blogs/avatar.jpg"><link rel="canonical" href="https://clovershrub.github.io/2022/11/22/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF逆向工程-2',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-19 12:57:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Clovershrub" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/blogs/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/cover.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Clovershrub"></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF逆向工程-2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2022-11-21T16:00:00.000Z" title="Created 2022-11-22 00:00:00">2022-11-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF逆向工程-2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="buuctf逆向工程-2">BUUCTF逆向工程-2</h1>
<h2 id="相册">相册</h2>
<p>打开后可以找到发送邮件的函数原型：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%E7%9B%B8%E5%86%8C1.png" alt=""><br>
根据交叉引用找到调用它的地方：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%E7%9B%B8%E5%86%8C2.png" alt=""><br>
可以知道C2.MAILSERVER应当为邮箱，根据交叉引用可以找到：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%E7%9B%B8%E5%86%8C3.png" alt=""><br>
这个函数加载了一个core文件，然后调用里面的NativeMethod.m()函数，查看它的Library：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%E7%9B%B8%E5%86%8C4.png" alt=""><br>
有一个libcore.so文件，将它用IDA打开，在java_com_net_cn_NativeMethod_m()函数中可以看见：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%E7%9B%B8%E5%86%8C5.png" alt=""><br>
查看base64方法中的shared可以拿到加密表：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%E7%9B%B8%E5%86%8C6.png" alt=""><br>
解密得到flag：18218465125@163.com</p>
<h2 id="mrctf2020-hello-world-go">[MRCTF2020]hello_world_go</h2>
<p>代码写得根本看不懂在干什么，但是瞎点一通发现unk_4D3C58里就是flag：hello_world_gogogo<br>
从结果来看应该是一个go语言，无语。。。</p>
<h2 id="wustctf2020-level3">[WUSTCTF2020]level3</h2>
<p>打开看见它想让我破译一个base64：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BWUSTCTF2020%5Dlevel31.png" alt=""><br>
点进加密函数可以跟踪到密码表：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BWUSTCTF2020%5Dlevel32.png" alt=""><br>
用这个密码表解码发现解出来是乱码…想到密码表可能被修改过，查看它的交叉引用：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BWUSTCTF2020%5Dlevel33.png" alt=""><br>
写个简单的脚本得到flag：Base64_is_the_start_of_reverse</p>
<h2 id="gwctf-2019-xxor">[GWCTF 2019]xxor</h2>
<p>打开看见：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGWCTF2019%5Dxxor1.png" alt=""><br>
前面一段对输入进行TEA，之后判断结果，解码脚本在此：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">int</span> *v, <span class="type">int</span> *k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], i;</span><br><span class="line">	<span class="type">int</span> delta = <span class="number">1166789954</span>;</span><br><span class="line">	<span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		sum += delta;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">		v1 -= (v0 + sum + <span class="number">20</span>) ^ ((v0 &lt;&lt; <span class="number">6</span>) + k[<span class="number">2</span>]) ^ ((v0 &gt;&gt; <span class="number">9</span>) + k[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">		v0 -= (v1 + sum + <span class="number">11</span>) ^ ((v1 &lt;&lt; <span class="number">6</span>) + k[<span class="number">0</span>]) ^ ((v1 &gt;&gt; <span class="number">9</span>) + k[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">		sum -= delta;</span><br><span class="line">	&#125; </span><br><span class="line">	v[<span class="number">0</span>] = v0;</span><br><span class="line">	v[<span class="number">1</span>] = v1;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> v[<span class="number">2</span>] = &#123;&#125;, k[<span class="number">4</span>] = &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> a1[<span class="number">6</span>] = &#123;<span class="number">-548868226</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">-2064448480</span>&#125;;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">2</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">        	v[<span class="number">0</span>] = a1[i*<span class="number">2</span>];</span><br><span class="line">        	v[<span class="number">1</span>] = a1[i*<span class="number">2</span>+<span class="number">1</span>];</span><br><span class="line">        	<span class="built_in">decrypt</span>(v, k);</span><br><span class="line">        	a1[i*<span class="number">2</span>] = v[<span class="number">0</span>];</span><br><span class="line">        	a1[i*<span class="number">2</span>+<span class="number">1</span>] = v[<span class="number">1</span>];</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">    	&#123;</span><br><span class="line">    		<span class="keyword">for</span>(j = <span class="number">2</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">    		&#123;</span><br><span class="line">    			<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, *((<span class="type">char</span> *)&amp;a1[i] + j));</span><br><span class="line">    		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：re_is_great!<br>
说实话，写完这题我仍然不是很理解HIDWORD、LODWORD和ELF的逆序存储，全靠IDA动调测算出数据的存储方式，然后进行逆推，再根据输出调整顺序。。。<br>
虽说篇幅不长，但是这个b干了我将近4个小时</p>
<h2 id="flareon4-igniteme">[FlareOn4]IgniteMe</h2>
<p>打开IDA，果然，C++写出来的程序最恶心了（虽然我喜欢用C++）：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn4%5DIgniteMe1.png" alt=""><br>
sub_4010F0是输入函数，sub_401050是加密函数：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn4%5DIgniteMe2.png" alt=""><br>
其中sub401000函数里面是一个__ROL4__函数，百度了半天我也没看明白，但是IDA动调之后可以看见最后v4=4，所以也可以写出脚本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">99</span>] = &#123;<span class="number">13</span>,  <span class="number">38</span>,  <span class="number">73</span>,  <span class="number">69</span>,  <span class="number">42</span>,  <span class="number">23</span>, <span class="number">120</span>,  <span class="number">68</span>,  <span class="number">43</span>, <span class="number">108</span>, </span><br><span class="line">   <span class="number">93</span>,  <span class="number">94</span>,  <span class="number">69</span>,  <span class="number">18</span>,  <span class="number">47</span>,  <span class="number">23</span>,  <span class="number">43</span>,  <span class="number">68</span>, <span class="number">111</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">86</span>,   <span class="number">9</span>,  <span class="number">95</span>,  <span class="number">69</span>,  <span class="number">71</span>, <span class="number">115</span>,  <span class="number">38</span>,  <span class="number">10</span>,  <span class="number">13</span>,  <span class="number">19</span>, </span><br><span class="line">   <span class="number">23</span>,  <span class="number">72</span>,  <span class="number">66</span>,   <span class="number">1</span>,  <span class="number">64</span>,  <span class="number">77</span>,  <span class="number">12</span>,   <span class="number">2</span>, <span class="number">105</span>&#125;;</span><br><span class="line">    <span class="type">int</span> flag[<span class="number">99</span>];</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">int</span> v4 = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">38</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">    	flag[i] = v4 ^ ans[i];</span><br><span class="line">    	v4 = flag[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">38</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">char</span>(flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得出flag：R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com</p>
<h2 id="wustctf2020-cr0ssfun">[WUSTCTF2020]Cr0ssfun</h2>
<p>没啥技术含量<br>
flag：cpp_@nd_r3verse_@re_fun</p>
<h2 id="flareon6-overlong">[FlareOn6]Overlong</h2>
<p>IDA中代码很短，理论上运行一遍就有答案：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn6%5DOverlong1.png" alt=""><br>
其中unk_402008是给定的175空间的数组，但是sub_401160中对于次数组的调用最多只有28*4=112空间，因此推测所传参数28太小，所以拖入x32dbg修改对应二进制值1C为AE：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn6%5DOverlong2.png" alt=""><br>
之后运行起来，即可得到结果：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn6%5DOverlong3.png" alt=""><br>
得到flag：I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com</p>
<h2 id="utctf2020-basic-re">[UTCTF2020]basic-re</h2>
<p>shift+F12:<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BUTCTF2020%5Dbasic-re1.png" alt=""><br>
得到flag：str1ngs_1s_y0ur_fr13nd</p>
<h2 id="flareon3-challenge1">[FlareOn3]Challenge1</h2>
<p>简单的变表base64，得到flag：sh00ting_phish_in_a_barrel@flare-on.com</p>
<h2 id="actf新生赛2020-oruga">[ACTF新生赛2020]Oruga</h2>
<p>这是一道比较抽象的迷宫题：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DOruga1.png" alt=""><br>
由这个可以推出地图是一个16*16的空间，长这个样子：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DOruga2.png" alt=""><br>
看一看它的校验部分：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DOruga3.png" alt=""><br>
它的v2在校验中就进行了更改，而下一次循环又不会对v2进行回溯，因此它走迷宫的路线会变成直来直去的样子。一直向某个方向走到底直到遇见非空的格子，同时还不能越界，因此路线为:<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DOruga4.png" alt=""><br>
得到flag：MEWEMEWJMEWJM</p>
<h2 id="bjdctf2020-bjd-hamburger-competition">[BJDCTF2020]BJD hamburger competition</h2>
<p>下载之后非常懵逼，是一个Unity的游戏，打开Visual Studio发现Unity的游戏使用C#写的，所以我们要在它给的一大坨东西里面找一个C#写的dll文件。发现在BJD hamburger competition_Data\Managed下有一个Assembly-CSharp.dll，使用dnSpy打开它，找到加密部分：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BBJDCTF2020%5DBJDhamburgercompetition1.png" alt=""><br>
跟踪Md5()，发现它截取了答案的前20位：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BBJDCTF2020%5DBJDhamburgercompetition2.png" alt=""><br>
写出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;DD01903921EA24941C26A48F2CEC24E0BB0E8CC7&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">10000000000000</span>):</span><br><span class="line">    <span class="keyword">if</span> hashlib.sha1(i.__str__().encode()).hexdigest().upper() == <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + hashlib.md5(i.__str__().encode()).hexdigest().upper()[<span class="number">0</span>:<span class="number">20</span>] + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>得到flag：B8C37E33DEFDE51CF91E</p>
<h2 id="特殊的-base64">特殊的 BASE64</h2>
<p>简单的变表base64，不得不说，C++的逆向代码看起来确实恶心<br>
得到flag：Special_Base64_By_Lich</p>
<h2 id="zer0pts2020-easy-strcmp">[Zer0pts2020]easy strcmp</h2>
<p>主函数内只有这些，提交发现这不是正确答案：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BZer0pts2020%5Deasystrcmp1.png" alt=""><br>
返回去看看init函数有没有进行一些什么操作：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BZer0pts2020%5Deasystrcmp2.png" alt=""><br>
发现它其实调用了一些函数，只不过是通过直接访问地址的形式调用的，双击funcs_889可以看到：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BZer0pts2020%5Deasystrcmp3.png" alt=""><br>
它调用了两个函数sub_6E0和函数sub_795，其中第一个没什么卵用，跟进第二个：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BZer0pts2020%5Deasystrcmp4.png" alt=""><br>
发现这个函数很神奇，将strcmp函数的地址传给了qword_201090，将sub_6EA函数的地址传给了off_201028，双击sub_6EA查看：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BZer0pts2020%5Deasystrcmp5.png" alt=""><br>
发现sub_6EA对参数做了一通操作，然后返回地址在qword_201090的函数的值，而这个函数恰好就是刚赋完值的strcmp函数。在sub_795函数里将sub_6EA函数的地址传给了off_201028，双击off_201028查看：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BZer0pts2020%5Deasystrcmp6.png" alt=""><br>
发现off_201028地址上的函数恰好又是strcmp函数。所以主函数里执行strcmp时其实先执行了sub_6EA函数，再执行strcmp函数，可以写出脚本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> p[<span class="number">99</span>] = <span class="string">&quot;zer0pts&#123;********CENSORED********&#125;&quot;</span>;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> k[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		*(<span class="type">long</span> <span class="type">long</span> *)&amp;(p[i * <span class="number">8</span>]) += k[i];</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; p;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>得到flag：l3ts_m4k3_4_DETOUR_t0d4y</p>
<h2 id="actf新生赛2020-universe-final-answer">[ACTF新生赛2020]Universe_final_answer</h2>
<p>是个简单的z3，此题大多数时间用在了z3的安装和调查使用教程，算出key的值之后用IDA动调一下即可：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DUniverse_final_answer1.png" alt=""><br>
得到flag：F0uRTy_7w@_42</p>
<h2 id="wustctf2020-level4">[WUSTCTF2020]level4</h2>
<p>这是个算法题，给出二叉树的中序遍历和后序遍历，求先序遍历。有一点神奇的是在IDA里静态或者动调的时候都没有找到它存放这些数据的地方…<br>
得到flag：This_IS_A_7reE</p>
<h2 id="crackme">crackMe</h2>
<p>代码逻辑非常清晰，但是代码很长，很恶心：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/crackMe1.png" alt=""><br>
先后输入用户名和密码，根据用户名在sub_401090()中创建byte_416050[]，在loc_4011A0()中创建Format[]和v4[]，跟进loc_4011A0()会有一个花指令，nop掉之后可以得知Format是正确提示且v3恒等于1，因此需要sub_401830()返回true，跟进sub_401830()：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/crackMe2.png" alt=""><br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/crackMe3.png" alt=""><br>
第一部分将password当成16进制数两两一组分割，存入v14[]。第二部分用v14[]和byte_416050[]创建v16[]，最后再用v16创建v13，进行判断。根据v5&lt;8可以得知v14[]长度为8。在sub_410470()中可以得知v16的值是“dbappsec”。跟进sub_401710()：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/crackMe4.png" alt=""><br>
虽然它判断了一堆情况，但是v4是用户名“welcomebeijing”的长度，v3最大为8，因此它只会执行else if的内容。将sub_401830()中第二部分内的两次反动调在汇编码中将jz改为jmp绕过，动调得到创建v16时的byte_416050[]的值。要注意在汇编码中，程序将byte_416050[v12+v7]的值传给了v12，再用v12进行异或，所以如果只看伪代码手动生成是不对的。写出脚本：、</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> ans[<span class="number">99</span>] = <span class="string">&quot;dbappsec&quot;</span>;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">99</span>] = <span class="string">&quot;welcomebeijing&quot;</span>;</span><br><span class="line">    <span class="type">int</span> XOR[<span class="number">99</span>] = &#123;<span class="number">0x2A</span>, <span class="number">0xD7</span>, <span class="number">0x92</span>, <span class="number">0xE9</span>, <span class="number">0x53</span>, <span class="number">0xE2</span>, <span class="number">0xC4</span>, <span class="number">0xCD</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i] ^= name[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i] ^= XOR[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>, ans[i] &amp; <span class="number">255</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到密码：39d09ffa4cfcc4cc，将程序中所有反动调全部patch掉然后动调检验，或者直接运行程序会看见程序退出证明成功（因为失败会让你继续输入）：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/crackMe5.png" alt=""><br>
将其md5之后提交显示不正确。百度搜索得知“正确”的解答中并没有分析sub_401710()，得到密码4eb5f3992391a1ae，很明显它不正确：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/crackMe6.png" alt=""><br>
得到<br>
可以通过提交的flag：d2be2981b84f2a905669995873d6a36c<br>
可以通过程序的flag：84ab2835640e510eb81f86e0ced4d91c</p>
<h2 id="网鼎杯-2020-青龙组-signal">[网鼎杯 2020 青龙组]signal</h2>
<p>这个东西滴加密比较复杂，有一张加密流程表，根据表单内容对输入进行各种赋值、异或、加减乘除。逆过来的话有一定的难度，所以，我决定请出angr：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(<span class="string">&#x27;signal.exe&#x27;</span>, auto_load_libs = <span class="literal">False</span>)</span><br><span class="line">init_state = p.factory.entry_state()</span><br><span class="line">s = p.factory.simgr(init_state)</span><br><span class="line">s.explore(find = <span class="number">0x0040179E</span>, avoid = <span class="number">0x00401539</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<p>得到flag：757515121f3d478<br>
超！这angr真nm好用！</p>
<h2 id="guet-ctf2019-number-game">[GUET-CTF2019]number_game</h2>
<p>很奇妙的一道题：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGUET-CTF2019%5Dnumber_game1.png" alt=""><br>
不是很能理解为什么sub_400758()返回值明明是个指针，但在其内部却可以把指针变量赋值给整型变量。在sub_400917()内查看矩阵的样子：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGUET-CTF2019%5Dnumber_game2.png" alt=""><br>
得到flag：1134240024</p>
<h2 id="findkey">findKey</h2>
<p>又一个非常恶心的C++，主函数东西很少，shift+F12找到关键词“flag{}”，双击跟进发现花指令，nop掉：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/findKey1.png" alt=""><br>
之后进入真正恶心的地方,关注函数sub_40101E：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/findKey2.png" alt=""><br>
和sub_401005<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/findKey3.png" alt=""><br>
sub_40101E进去发现：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/findKey4.png" alt=""><br>
0x8003u是MD5加密的特征值，因此判定整个函数用于MD5。<br>
对于第一个sub_401005，就是将那一长串绿色的东西每一位异或‘S’，得到的东西应该为MD5之后的输入，在线解密得到123321。而第二个sub_401005并没有找到v5-492对应的值，猜测就是输入,结果证明我猜对了。附上解密脚本</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> key[<span class="number">99</span>] = &#123;<span class="number">87</span>, <span class="number">94</span>, <span class="number">82</span>, <span class="number">84</span>, <span class="number">73</span>, <span class="number">95</span>, <span class="number">1</span>, <span class="number">109</span>, <span class="number">105</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">95</span>, <span class="number">2</span>, <span class="number">108</span>, <span class="number">87</span>, <span class="number">91</span>, <span class="number">84</span>, <span class="number">76</span>&#125;;</span><br><span class="line">    <span class="type">char</span> ans[<span class="number">99</span>] = <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span>;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	ans[i] ^= <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">    	cout &lt;&lt; <span class="built_in">char</span>(ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="type">char</span> k[<span class="number">9</span>] = <span class="string">&quot;123321&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">  	key[i] ^= k[i % <span class="number">6</span>];</span><br><span class="line">	cout &lt;&lt; <span class="built_in">char</span>(key[i]); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：n0_Zu0_n0_die<br>
确实，no zuo no die，没事别碰逆向，这个b又干了我4个小时。</p>
<h2 id="羊城杯-2020-easyre">[羊城杯 2020]easyre</h2>
<p>这个没啥，就是繁，encodeone进行base64，encodetwo乾坤大挪移，encodethree凯撒，逆过来就行<br>
得到flag：672cc4778a38e80cb362987341133ea2</p>
<h2 id="网鼎杯-2020-青龙组-jocker">[网鼎杯 2020 青龙组]jocker</h2>
<p>打开看见SMC，所以它前面的东西一定是假的，看都不用看。修改完之后得到两个被隐藏的函数encrypt()和Finally()。<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84%5Djocker1.png" alt=""><br>
encrypt()函数逻辑很清晰，用输入去异或Buffer得到unk_403040。<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84%5Djocker2.png" alt=""><br>
但是这个Finally()函数中以time(0)作为种子取随机数，也就是说，你是极大概率得不到出题人当时的情况的。经百度，这里需要你去猜，同样也是异或加密，而且是跟v2异或。<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF2020%E9%9D%92%E9%BE%99%E7%BB%84%5Djocker3.png" alt=""><br>
根据猜到的结果写出脚本:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">999</span>] = &#123;<span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">88</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">62</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">87</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">87</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>&#125;;</span><br><span class="line">    <span class="type">char</span> XOR1[<span class="number">99</span>] = <span class="string">&quot;hahahaha_do_you_find_me?&quot;</span>;</span><br><span class="line">    <span class="type">char</span> XOR2[<span class="number">99</span>] = <span class="string">&quot;%tp&amp;:&quot;</span>;</span><br><span class="line">    <span class="type">int</span> flag[<span class="number">99</span>], temp;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">19</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] = ans[i*<span class="number">4</span>] ^ XOR1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    temp = <span class="string">&#x27;&#125;&#x27;</span> ^ <span class="string">&#x27;:&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i+<span class="number">19</span>] = temp ^ XOR2[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：d07abccf8a410cb37a<br>
不是很认可这种本地打不通的题。。。</p>
<h2 id="flareon5-minesweeper-championship-registration">[FlareOn5]Minesweeper Championship Registration</h2>
<p>是个java的程序，没逆过，但是拖进IDA就能得到flag：GoldenTicket2018@flare-on.com</p>
<h2 id="firmware">firmware</h2>
<p>固件逆向，不想学，看<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_64558075/article/details/122156963">这里</a>吧。<br>
得到flag：33a422c45d551ac6e4756f59812a954b</p>
<h2 id="actf新生赛2020-soullike">[ACTF新生赛2020]SoulLike</h2>
<p>一起来感受3000行屎山代码的美，没有含金量，flag：b0Nf|Re_LiT!</p>
<h2 id="gwctf-2019-re3">[GWCTF 2019]re3</h2>
<p>第一次见，代码自修改问题：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGWCTF2019%5Dre31.png" alt=""><br>
在file/Script command中编写idc脚本：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGWCTF2019%5Dre32.png" alt=""><br>
转成代码并构造函数，得到被隐藏的内容：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGWCTF2019%5Dre33.png" alt=""><br>
使用findcrypt插件可以得知sub_400A71()和sub_40196E()和AES加密有关。unk_603170为秘钥。找到生成它的地方：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGWCTF2019%5Dre34.png" alt=""><br>
插件提示sub_401CF9()为md5加密。从伪代码来看秘钥只与第一和第五个md5有关，然而手动生成与动调结果并不一致。写出解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = [<span class="number">0xBC</span>, <span class="number">0x0A</span>, <span class="number">0xAD</span>, <span class="number">0xC0</span>, <span class="number">0x14</span>, <span class="number">0x7C</span>, <span class="number">0x5E</span>, <span class="number">0xCC</span>, <span class="number">0xE0</span>, <span class="number">0xB1</span>, <span class="number">0x40</span>, <span class="number">0xBC</span>, <span class="number">0x9C</span>, <span class="number">0x51</span>, <span class="number">0xD5</span>, <span class="number">0x2B</span>, <span class="number">0x46</span>, <span class="number">0xB2</span>, <span class="number">0xB9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0xE5</span>, <span class="number">0x32</span>, <span class="number">0x4B</span>, <span class="number">0xAD</span>, <span class="number">0x7F</span>, <span class="number">0xB4</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0xDB</span>, <span class="number">0x4B</span>, <span class="number">0x5B</span>]</span><br><span class="line">k = [<span class="number">0xCB</span>, <span class="number">0x8D</span>, <span class="number">0x49</span>, <span class="number">0x35</span>, <span class="number">0x21</span>, <span class="number">0xB4</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, <span class="number">0xC1</span>, <span class="number">0xAE</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x92</span>, <span class="number">0x66</span>, <span class="number">0xCE</span>]</span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">key = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    ans += <span class="string">&quot;&#123;:02x&#125;&quot;</span>.<span class="built_in">format</span>(a[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k)):</span><br><span class="line">    key += <span class="string">&quot;&#123;:02x&#125;&quot;</span>.<span class="built_in">format</span>(k[i])</span><br><span class="line">ans = <span class="built_in">int</span>(ans, <span class="number">16</span>)</span><br><span class="line">key = <span class="built_in">int</span>(key, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">aes = AES.new(long_to_bytes(key), mode = AES.MODE_ECB)</span><br><span class="line">flag = aes.decrypt(long_to_bytes(ans))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>得到flag：924a9ab2163d390410d0a1f670</p>
<h2 id="gxyctf2019-simple-cpp">[GXYCTF2019]simple CPP</h2>
<p>今天也是讨厌C++逆向的一天呢~<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGXYCTF2019%5DsimpleCPP1.png" alt=""><br>
异或的东西可以通过动调得到<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGXYCTF2019%5DsimpleCPP2.png" alt=""><br>
然后是<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGXYCTF2019%5DsimpleCPP3.png" alt=""><br>
接着是<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BGXYCTF2019%5DsimpleCPP4.png" alt=""><br>
最后那一大坨考虑使用z3：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">x = BitVec(<span class="string">&#x27;x&#x27;</span>, <span class="number">64</span>)<span class="comment">#用Int进行不了~运算</span></span><br><span class="line">y = BitVec(<span class="string">&#x27;y&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">z = BitVec(<span class="string">&#x27;z&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">w = BitVec(<span class="string">&#x27;w&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">s.add(z &amp; (~x) == <span class="number">0x11204161012</span>)</span><br><span class="line">s.add(<span class="number">0x3E3A4717373E7F1F</span> ^ w == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line">s.add(<span class="number">0x11204161012</span> | (x &amp; y) | (z &amp; (~y)) | (x &amp; (~y)) == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line">s.add((z &amp; (~y)) &amp; x | z &amp; ((x &amp; y) | y &amp; ~x | ~(y | x)) == <span class="number">0x8020717153E3013</span>)</span><br><span class="line">s.add(<span class="number">0x11204161012</span> | (x &amp; y) | y &amp; z == ~x &amp; z | <span class="number">0xC00020130082C0C</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check():</span><br><span class="line">    r = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> r:</span><br><span class="line">        <span class="built_in">print</span>(i, <span class="built_in">hex</span>(r[i].as_long()))</span><br></pre></td></tr></table></figure>
<p>将得到的答案在异或回去：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans[<span class="number">99</span>];</span><br><span class="line">    <span class="type">char</span> XOR[] = <span class="string">&quot;i_will_check_is_debug_or_not&quot;</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> i, j, flag[<span class="number">99</span>];</span><br><span class="line">    ans[<span class="number">1</span>] = <span class="number">865872043546520588</span>;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">4483973367147818765</span>;</span><br><span class="line">    ans[<span class="number">3</span>] = <span class="number">842073600</span>;</span><br><span class="line">    ans[<span class="number">2</span>] = <span class="number">577031497978884115</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                flag[i*<span class="number">8</span>+j] = (ans[i] &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">                ans[i] = ans[i] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                flag[i*<span class="number">8</span>+j] = (ans[i] &amp; <span class="number">0xFF00000000000000</span>) &gt;&gt; <span class="number">56</span>;</span><br><span class="line">                ans[i] = ans[i] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">27</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] ^= XOR[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后就可以得到乱码<code>We1l_D0ndaQbg�_Slgebra_am_i</code><br>
经百度，是题错了，z3解出来不止一组解。挺神奇的，5个条件约束不住4个数。<br>
得到flag：We1l_D0ne!P0or_algebra_am_i</p>
<h2 id="flareon5-ultimate-minesweeper">[FlareOn5]Ultimate Minesweeper</h2>
<p>get了一个dnSpy的新玩法。拖进去容易找到加密函数：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn5%5DUltimateMinesweeper1.png" alt=""><br>
但是仔细看一看发现它用revealedCells作为种子生成了一个随机数数组array，之后在加密输出。因此想法是动调，查看一下会让我们失败的函数：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn5%5DUltimateMinesweeper2.png" alt=""><br>
根据英文提示，第一个if就是失败判定，把它右键、编辑方法，给它注释掉：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn5%5DUltimateMinesweeper3.png" alt=""><br>
右下角编译之后Ctrl+shift+s保存为新程序，运行新程序，找到三个非雷地块：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn5%5DUltimateMinesweeper4.png" alt=""><br>
之后再在正常的程序里点击这三个地块，得到flag：Ch3aters_Alw4ys_W1n@flare-on.com</p>
<h2 id="mrctf2020-pixelshooter">[MRCTF2020]PixelShooter</h2>
<p>附件是一个apk，但是里面有很多unity的关键字，所以去找Assembly-CSharp.dll：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BMRCTF2020%5DPixelShooter1.png" alt=""><br>
导出后拖进dnSpy，在UIControler方法中找到：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BMRCTF2020%5DPixelShooter2.png" alt=""><br>
得到flag：Unity_1S_Fun_233</p>
<h2 id="flareon1-bob-doge">[FlareOn1]Bob Doge</h2>
<p>又是一个C#的程序，拖入dnSpy，容易找到加密函数：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn1%5DBobDoge1.png" alt=""><br>
发现需要寻找dat_secret，可惜找不到（话说，这玩意儿是怎么藏起来的？），所以准备动调：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BFlareOn1%5DBobDoge2.png" alt=""><br>
在数据栏中得到flag：3rmahg3rd.b0b.d0ge@flare-on.com</p>
<h2 id="2019红帽杯-xx">[2019红帽杯]xx</h2>
<p>红帽杯的题总能让我眼前一黑<br>
首先判断输入位数为19位，然后判断输入的值是不是在特定字符串里。<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx1.png" alt=""><br>
然后构造key，发现key保留了输入的前4个，其余的赋0，再将其转为4个32位数用于XXTEA。然后你需要坚定不移地猜输入的前4个就是&quot;flag&quot;。XXTEA的代码是真心没看懂，但好在他是标准的。通过动调可以知道如果输入为1234，在XXTEA中input会变成34333231，解密时要注意大小端序。<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx2.png" alt=""><br>
对加密结果进行打乱，并且进行了一个离谱的异或。解异或需要从后往前解。<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx3.png" alt=""><br>
最后进行对比，这种赋值方式也会产生大小端序的问题，算不过来的话…动调吧！骚年！<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx4.png" alt=""><br>
写出脚本:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">XXTEA</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *v, <span class="type">int</span> n, <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">    sum = rounds * DELTA;</span><br><span class="line">    y = v[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            z = v[p - <span class="number">1</span>];</span><br><span class="line">            y = v[p] -= MX;</span><br><span class="line">        &#125;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">99</span>] = &#123;<span class="number">206</span>, <span class="number">188</span>,  <span class="number">64</span>, <span class="number">107</span>, <span class="number">124</span>,  <span class="number">58</span>, <span class="number">149</span>, <span class="number">192</span>, <span class="number">239</span>, <span class="number">155</span>,  <span class="number">32</span>,  <span class="number">32</span>, <span class="number">145</span>, <span class="number">247</span>,   <span class="number">2</span>,  <span class="number">53</span>,  <span class="number">35</span>,  <span class="number">24</span>,   <span class="number">2</span>, <span class="number">200</span>, <span class="number">231</span>,  <span class="number">86</span>,  <span class="number">86</span>, <span class="number">250</span>&#125;, enc[<span class="number">99</span>];</span><br><span class="line">    <span class="type">int</span> v21 = <span class="number">23</span>, v22 = <span class="number">23</span>, i, j;</span><br><span class="line">    <span class="keyword">for</span>(; v21 &gt;= <span class="number">1</span>; v22--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v23 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(v21 / <span class="number">3</span> &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">                ans[v22] ^= ans[v23];</span><br><span class="line">                v23++;</span><br><span class="line">            &#125; <span class="keyword">while</span> (v23 &lt; v21 / <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        v21--;</span><br><span class="line">    &#125;</span><br><span class="line">    enc[<span class="number">2</span>] = ans[<span class="number">0</span>];</span><br><span class="line">    enc[<span class="number">0</span>] = ans[<span class="number">1</span>];</span><br><span class="line">    enc[<span class="number">3</span>] = ans[<span class="number">2</span>];</span><br><span class="line">    enc[<span class="number">1</span>] = ans[<span class="number">3</span>];</span><br><span class="line">    enc[<span class="number">6</span>] = ans[<span class="number">4</span>];</span><br><span class="line">    enc[<span class="number">4</span>] = ans[<span class="number">5</span>];</span><br><span class="line">    enc[<span class="number">7</span>] = ans[<span class="number">6</span>];</span><br><span class="line">    enc[<span class="number">5</span>] = ans[<span class="number">7</span>];</span><br><span class="line">    enc[<span class="number">10</span>] = ans[<span class="number">8</span>];</span><br><span class="line">    enc[<span class="number">8</span>] = ans[<span class="number">9</span>];</span><br><span class="line">    enc[<span class="number">11</span>] = ans[<span class="number">10</span>];</span><br><span class="line">    enc[<span class="number">9</span>] = ans[<span class="number">11</span>];</span><br><span class="line">    enc[<span class="number">14</span>] = ans[<span class="number">12</span>];</span><br><span class="line">    enc[<span class="number">12</span>] = ans[<span class="number">13</span>];</span><br><span class="line">    enc[<span class="number">15</span>] = ans[<span class="number">14</span>];</span><br><span class="line">    enc[<span class="number">13</span>] = ans[<span class="number">15</span>];</span><br><span class="line">    enc[<span class="number">18</span>] = ans[<span class="number">16</span>];</span><br><span class="line">    enc[<span class="number">16</span>] = ans[<span class="number">17</span>];</span><br><span class="line">    enc[<span class="number">19</span>] = ans[<span class="number">18</span>];</span><br><span class="line">    enc[<span class="number">17</span>] = ans[<span class="number">19</span>];</span><br><span class="line">    enc[<span class="number">22</span>] = ans[<span class="number">20</span>];</span><br><span class="line">    enc[<span class="number">20</span>] = ans[<span class="number">21</span>];</span><br><span class="line">    enc[<span class="number">23</span>] = ans[<span class="number">22</span>];</span><br><span class="line">    enc[<span class="number">21</span>] = ans[<span class="number">23</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> flag[<span class="number">99</span>];</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] = (flag[i] &lt;&lt; <span class="number">8</span>) + enc[i*<span class="number">4</span>+j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;<span class="number">0x67616c66</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">XXTEA</span>(flag, <span class="number">6</span>, key);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">            flag[i] &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag：CXX_and_++tea</p>
<h2 id="cfi-ctf-2018-introtope">[CFI-CTF 2018]IntroToPE</h2>
<p>这道题就比较水了，打开找到判断函数：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BCFI-CTF2018%5DIntroToPE1.png" alt=""><br>
可以看出，应当使validatePassword.verifyPassword()返回真值，双击跟踪：<br>
<img src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2/%5BCFI-CTF2018%5DIntroToPE2.png" alt=""><br>
看见是一个base64，理论上应该接着去找加密使用的对应表，可惜没找到，就用默认的吧。<br>
得到flag：.NetC#_1s_@w3s0m3</p>
<h2 id="equation">equation</h2>
<p>非常sb的一道题，先jsfuck，再z3。<br>
得到flag：A_l0ng_10NG_eqU4Ti0n_1s_E4Sy_W1Th_z3</p>
</article><div class="tag_share"><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/12/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" title="PE文件结构"><img class="cover" src="/img/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">PE文件结构</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/20/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-1/" title="BUUCTF逆向工程-1"><img class="cover" src="/img/BUUCTF%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-1/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">BUUCTF逆向工程-1</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/blogs/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Clovershrub</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#buuctf%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B-2"><span class="toc-text">BUUCTF逆向工程-2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C"><span class="toc-text">相册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-hello-world-go"><span class="toc-text">[MRCTF2020]hello_world_go</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-level3"><span class="toc-text">[WUSTCTF2020]level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gwctf-2019-xxor"><span class="toc-text">[GWCTF 2019]xxor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flareon4-igniteme"><span class="toc-text">[FlareOn4]IgniteMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-cr0ssfun"><span class="toc-text">[WUSTCTF2020]Cr0ssfun</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flareon6-overlong"><span class="toc-text">[FlareOn6]Overlong</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#utctf2020-basic-re"><span class="toc-text">[UTCTF2020]basic-re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flareon3-challenge1"><span class="toc-text">[FlareOn3]Challenge1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#actf%E6%96%B0%E7%94%9F%E8%B5%9B2020-oruga"><span class="toc-text">[ACTF新生赛2020]Oruga</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf2020-bjd-hamburger-competition"><span class="toc-text">[BJDCTF2020]BJD hamburger competition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84-base64"><span class="toc-text">特殊的 BASE64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zer0pts2020-easy-strcmp"><span class="toc-text">[Zer0pts2020]easy strcmp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#actf%E6%96%B0%E7%94%9F%E8%B5%9B2020-universe-final-answer"><span class="toc-text">[ACTF新生赛2020]Universe_final_answer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-level4"><span class="toc-text">[WUSTCTF2020]level4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crackme"><span class="toc-text">crackMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-signal"><span class="toc-text">[网鼎杯 2020 青龙组]signal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#guet-ctf2019-number-game"><span class="toc-text">[GUET-CTF2019]number_game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#findkey"><span class="toc-text">findKey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easyre"><span class="toc-text">[羊城杯 2020]easyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-jocker"><span class="toc-text">[网鼎杯 2020 青龙组]jocker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flareon5-minesweeper-championship-registration"><span class="toc-text">[FlareOn5]Minesweeper Championship Registration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#firmware"><span class="toc-text">firmware</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#actf%E6%96%B0%E7%94%9F%E8%B5%9B2020-soullike"><span class="toc-text">[ACTF新生赛2020]SoulLike</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gwctf-2019-re3"><span class="toc-text">[GWCTF 2019]re3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gxyctf2019-simple-cpp"><span class="toc-text">[GXYCTF2019]simple CPP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flareon5-ultimate-minesweeper"><span class="toc-text">[FlareOn5]Ultimate Minesweeper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-pixelshooter"><span class="toc-text">[MRCTF2020]PixelShooter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flareon1-bob-doge"><span class="toc-text">[FlareOn1]Bob Doge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-xx"><span class="toc-text">[2019红帽杯]xx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cfi-ctf-2018-introtope"><span class="toc-text">[CFI-CTF 2018]IntroToPE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#equation"><span class="toc-text">equation</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/20/%5BTSCTF-J2024%5D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E%E9%A2%98%E8%A7%A3/" title="[TSCTF-J2024]二进制漏洞题解"><img src="/img/%5BTSCTF-J2024%5D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E%E9%A2%98%E8%A7%A3/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[TSCTF-J2024]二进制漏洞题解"/></a><div class="content"><a class="title" href="/2024/09/20/%5BTSCTF-J2024%5D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E%E9%A2%98%E8%A7%A3/" title="[TSCTF-J2024]二进制漏洞题解">[TSCTF-J2024]二进制漏洞题解</a><time datetime="2024-09-19T16:00:00.000Z" title="Created 2024-09-20 00:00:00">2024-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/19/DubheCTF-Destination&amp;Moon/" title="DubheCTF-Destination&amp;Moon"><img src="/img/DubheCTF-Destination&amp;Moon/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DubheCTF-Destination&amp;Moon"/></a><div class="content"><a class="title" href="/2024/03/19/DubheCTF-Destination&amp;Moon/" title="DubheCTF-Destination&amp;Moon">DubheCTF-Destination&amp;Moon</a><time datetime="2024-03-18T16:00:00.000Z" title="Created 2024-03-19 00:00:00">2024-03-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/02/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8/" title="天堂之门"><img src="/img/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="天堂之门"/></a><div class="content"><a class="title" href="/2024/02/02/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8/" title="天堂之门">天堂之门</a><time datetime="2024-02-01T16:00:00.000Z" title="Created 2024-02-02 00:00:00">2024-02-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/26/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B/" title="傀儡进程"><img src="/img/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B/cover.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="傀儡进程"/></a><div class="content"><a class="title" href="/2024/01/26/%E5%82%80%E5%84%A1%E8%BF%9B%E7%A8%8B/" title="傀儡进程">傀儡进程</a><time datetime="2024-01-25T16:00:00.000Z" title="Created 2024-01-26 00:00:00">2024-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/23/COM%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/" title="COM劫持实现提权"><img src="/img/COM%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="COM劫持实现提权"/></a><div class="content"><a class="title" href="/2024/01/23/COM%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/" title="COM劫持实现提权">COM劫持实现提权</a><time datetime="2024-01-22T16:00:00.000Z" title="Created 2024-01-23 00:00:00">2024-01-23</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/blogs/foot.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By Clovershrub</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="255,0,150" opacity="0.7" zIndex="-1" count="200" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>